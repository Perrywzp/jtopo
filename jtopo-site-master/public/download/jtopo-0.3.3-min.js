!function(a){JTopo={version:"0.3.3"},a.JTopo=JTopo}(window),function(a){function b(a){var b=this;this.name=a,this.messageMap={},this.messageCount=0,this.subscribe=function(a,d){var e=b.messageMap[a];null==e&&(b.messageMap[a]=[]),b.messageMap[a].push(d),b.messageCount++},this.unsubscribe=function(a){var c=b.messageMap[a];null!=c&&(b.messageMap[a]=null,delete b.messageMap[a],b.messageCount--)},this.publish=function(a,c,d){var f,e=b.messageMap[a];if(null!=e)for(f=0;f<e.length;f++)d?function(a,b){setTimeout(function(){a(b)},10)}(e[f],c):e[f](c)}}function c(a,b){var c=b.x-a.x,d=b.y-a.y;return Math.sqrt(c*c+d*d)}function d(a){return a.pageX||a.pageY?{x:a.pageX,y:a.pageY}:{x:a.clientX+document.body.scrollLeft-document.body.clientLeft,y:a.clientY+document.body.scrollTop-document.body.clientTop}}function e(a){var b,c;return a=a||d(window.event),b=document.body.scrollLeft+(a.x||a.layerX),c=document.body.scrollTop+(a.y||a.layerY),{x:b,y:c}}function f(a,b,c,d,e){var f=c-a,g=d-b,h=Math.sqrt(f*f+g*g),i=Math.atan2(g,f)+e;return{x:a+Math.cos(i)*h,y:b+Math.sin(i)*h}}function g(a,b,c){var e,g,d=[];for(e=0;e<b.length;e++)g=f(a.x,a.y,b[e].x,b[e].y,c),d.push(g);return d}function h(a,b,c){function e(d){d!=a.length&&(b(a[d]),setTimeout(function(){e(++d)},c))}if(0!=a.length){var d=0;e(d)}}function i(a,b,c,d){function f(a){a!=b&&(c(b),setTimeout(function(){f(++a)},d))}if(!(a>b)){var e=0;f(e)}}function j(a){var c,b={};for(c in a)b[c]=a[c];return b}function k(a,b){var c=b.x,d=b.y,e=b.width,f=b.height;return a.x>c&&a.x<c+e&&a.y>d&&a.y<d+f}Array.prototype.del=function(a){if("number"!=typeof a){for(var b=0;b<this.length;b++)if(this[b]===a)return this.slice(0,b).concat(this.slice(b+1,this.length));return this}return 0>a?this:this.slice(0,a).concat(this.slice(a+1,this.length))},[].indexOf||(Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return b;return-1}),window.console||(window.console={log:function(){},info:function(){},debug:function(){},warn:function(){},error:function(){}}),a.util={rotatePoint:f,rotatePoints:g,getDistance:c,getXY:e,mouseCoords:d,MessageBus:b,isIE:!+[1],clone:j,isPointInRect:k},window.$for=i,window.$foreach=h}(JTopo),function(a){function b(b){function d(b){var d=a.util.getXY(b);return{x:d.x-c.offsetX,y:d.y-c.offsetY}}function e(a){var b=d(a);return{x:b.x-c.translateX,y:b.y-c.translateY,button:a.button,ctrlKey:a.ctrlKey,altKey:a.altKey,shiftKey:a.shiftKey,pageX:a.pageX,pageY:a.pageY,scene:c.currentScene}}var f,c=this;a.stage=c,this.initialize=function(){this.scenes=[],this.width=0,this.height=0,this.frames=16,this.messageBus=new a.util.MessageBus,this.currentScene=null,this.canvas=b,this.width=b.width,this.height=b.height,this.graphics=b.getContext("2d"),this.offsetX=b.offsetLeft,this.offsetY=b.offsetTop,this.mode="select",this.translateX=0,this.translateY=0,this.mouseDownX=0,this.mouseDownY=0,this.isOnMouseDown=!1,this.controlRect={width:10,height:10}},this.initialize(),f=!0,b.addEventListener("mouseout",function(){f=!0,document.onselectstart=function(){return!0}}),b.addEventListener("mouseover",function(){f=!1,document.onselectstart=function(){return!1}}),document.oncontextmenu=function(){return f},b.addEventListener("mousedown",function(a){var b=e(a);c.dispatchEvent("mousedown",b),c.isOnMouseDown=!0,c.mouseDownX=b.x,c.mouseDownY=b.y,("select"==c.mode||"edit"==c.mode)&&c.currentScene&&c.currentScene.mousedownHander(b)}),b.addEventListener("mouseup",function(a){var b=e(a);c.dispatchEvent("mouseup",b),c.isOnMouseDown=!1,("select"==c.mode||"edit"==c.mode)&&c.currentScene&&c.currentScene.mouseupHander(b)}),b.addEventListener("mousemove",function(a){var f,g;c.isOnMouseDown&&"drag"==c.mode&&(f=d(a),c.translateX=f.x-c.mouseDownX,c.translateY=f.y-c.mouseDownY),"drag"==c.mode?b.style.cursor="pointer":"select"==c.mode?b.style.cursor="default":"edit"==c.mode&&(b.style.cursor="default"),g=e(a),c.dispatchEvent("mousemove",g),("select"==c.mode||"edit"==c.mode)&&c.currentScene&&c.currentScene.mousemoveHander(g)}),b.addEventListener("click",function(a){var b=e(a);c.dispatchEvent("click",b),("select"==c.mode||"edit"==c.mode)&&c.currentScene&&c.currentScene.clickHander(b)}),b.addEventListener("dblclick",function(a){var b=e(a);c.dispatchEvent("dbclick",b),("select"==c.mode||"edit"==c.mode)&&c.currentScene&&c.currentScene.dbclickHander(b)}),window.addEventListener("keydown",function(a){c.dispatchEvent("keydown",a),c.currentScene&&c.currentScene.keydownHander(a)},!0),window.addEventListener("keyup",function(a){c.dispatchEvent("keyup",a),c.currentScene&&c.currentScene.keyupHander(a)},!0),this.play=function(a){return this.currentScene&&this.currentScene.hide(),this.currentScene=a,a.show(),this},this.remove=function(a){for(var b=0;b<this.scenes.length;b++)if(this.scenes[b]===a)return this.scenes=this.scenes.del(b),this},this.addEventListener=function(a,b){return this.messageBus.subscribe(a,b),this},this.dispatchEvent=function(a,b){return this.messageBus.publish(a,b),this},this.saveImageInfo=function(){var a=this.canvas.toDataURL("image/png"),b=window.open("about:blank","image from canvas");return b.document.write("<img src='"+a+"' alt='from canvas'/>"),this},this.saveAsLocalImage=function(){var a=this.canvas.toDataURL("image/png").replace("image/png","image/octet-stream");return window.location.href=a,this},this.repaint=function(){return c.currentScene&&(this.graphics.save(),this.graphics.translate(this.translateX,this.translateY),c.currentScene.repaint(),this.graphics.restore()),this},function(){c.repaint(),setTimeout(arguments.callee,1e3/c.frames)}()}a.Stage=b}(JTopo),function(a){function b(){this.initialize=function(b){this.visible=!1,this.rotate=0,this.alpha=1,this.elements=[],this.elementMap={},this.messageBus=new a.util.MessageBus,this.background=null,this.style={fillStyle:"238,238,238"},this.shadow=!0,this.operations=[],this.stage=b,this.stage.scenes.push(this),this.width=b.width,this.height=b.height,this.graphics=b.graphics},this.show=function(){this.visible=!0,this.paint()},this.hide=function(){this.visible=!1},this.clear=function(){this.elements=[],this.elementMap=[],this.operations=[]},this.paintElements=function(a){var c,d,e,f,b=this.graphics;for(c=0;c<a.length;c++)d=a[c],1==d.visible&&(b.save(),0==d.shadow&&(b.shadowBlur=0,b.shadowOffsetX=0,b.shadowOffsetY=0),d.translate&&(e=d.scalaX||1,f=d.scalaY||1,b.translate(d.x+d.width*e/2,d.y+d.height*f/2),d.rotate&&b.rotate(d.rotate),d.scalaX&&d.scalaY?b.scale(d.scalaX,d.scalaY):d.scalaX?b.scale(d.scalaX,1):d.scalaY&&b.scale(1,d.scalaY)),d.paint(b),b.restore(),"edit"==this.stage.mode&&1==d.editable&&1==d.selected&&this.paintControlPoints(d))},this.getElementControlRects=function(a){var g,h,b=this.stage.controlRect.width,c=this.stage.controlRect.height,d=a.width*a.scalaX,e=a.height*a.scalaY,f={};f.top_left={x:-d/2-b,y:-e/2-c},f.top_center={x:-(b/2),y:-e/2-c},f.top_right={x:d/2,y:-e/2-c},f.middle_left={x:-d/2-b,y:-(c/2)},f.middle_right={x:d/2,y:-(c/2)},f.bottom_left={x:-d/2-b,y:e/2},f.bottom_center={x:-(b/2),y:e/2},f.bottom_right={x:d/2,y:e/2};for(g in f)h=f[g],h.position=g,h.width=this.stage.controlRect.width,h.height=this.stage.controlRect.height;return f},this.paintControlPoints=function(a){var e,f,g,h,i,j,k,b=this.graphics,c=this.stage.controlRect.width,d=this.stage.controlRect.height;b.save(),a.translate&&(e=a.scalaX||1,f=a.scalaY||1,b.translate(a.x+a.width*e/2,a.y+a.height*f/2)),b.strokeStyle="rgb(255,255,255)",b.shadowBlur=0,b.shadowOffsetX=0,b.shadowOffsetY=0,b.beginPath(),g=this.getElementControlRects(a);for(h in g)i=g[h],j=i.x,k=i.y,b.rect(j,k,c,d);b.stroke(),b.closePath(),b.restore()},this.paintOperations=function(a){for(var b=0;b<a.length;b++)a[b](this.graphics)},this.addOperation=function(a){return this.operations.push(a),this},this.clearOperations=function(){return this.operations=[],this};var c={};this.setBackground=function(a){if("string"==typeof a){var b=c[a];null==b&&(b=new Image,b.src=a,c[a]=b),this.background=b}else this.background=a},this.paintBackgroud=function(a){this.graphics.save(),this.background?this.graphics.drawImage(a,-this.stage.translateX,-this.stage.translateY,this.width,this.height):(this.graphics.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",this.graphics.fillRect(-this.stage.translateX,-this.stage.translateY,this.width,this.height)),this.graphics.restore()},this.paint=function(){if(this.visible){this.graphics.clearRect(0,0,this.width,this.height);var a=this.graphics;a.save(),this.shadow&&(this.graphics.shadowBlur=5,this.graphics.shadowColor="rgba(0,0,0,0.5)",this.graphics.shadowOffsetX=3,this.graphics.shadowOffsetY=6),this.paintBackgroud(this.background),this.paintElements(this.elements),this.paintOperations(this.operations),a.restore()}},this.repaint=function(){this.paint()},this.add=function(a){a.id||(a.id="id_"+(new Date).getTime()+this.elements.length),this.elementMap[a.id]||(this.elementMap[a.id]=a,this.elements.push(a))},this.remove=function(a){this.removeFromArray("elements",a)},this.removeFromArray=function(a,b){var d,e,c="string"==typeof b?b:b.id;if(null!=b.id){for(this.elementMap[c]&&delete this.elementMap[c],d=0;d<this[a].length;d++)if(e=this[a][d],e.id===c)return this[a]=this[a].del(d),e;return null}},this.getelementByXY=function(a,b){var d,e,c=null;for(d=this.elements.length-1;d>=0;d--)if(e=this.elements[d],e.translate){if(a>e.x&&a<e.x+e.width*e.scalaX&&b>e.y&&b<e.y+e.height*e.scalaY){c=e;break}}else if(a>e.x&&a<e.x+e.width&&b>e.y&&b<e.y+e.height){c=e;break}return c},this.toSceneEvent=function(b){return a.util.clone(b)},this.mousedownHander=function(a){var b=this.toSceneEvent(a);this.dispatchEvent("_mousedown",b)},this.clickHander=function(a){var b=this.toSceneEvent(a);this.dispatchEvent("_click",b)},this.dbclickHander=function(a){var b,c,d;this.isOnDbclick=!0,b=a.x,c=a.y,this.dbclickX=b,this.dbclickY=c,d=this.toSceneEvent(a),this.dispatchEvent("_dbclick",d)},this.mousemoveHander=function(a){var b=this.toSceneEvent(a),c=b.x,d=b.y;this.stage.isOnMouseDown?(b.dx=c-this.stage.mouseDownX,b.dy=d-this.stage.mouseDownY,this.dispatchEvent("_mousedrag",b)):this.dispatchEvent("_mousemove",b)},this.mouseupHander=function(a){a.x,a.y;var d=this.toSceneEvent(a);this.dispatchEvent("_mouseup",d)},this.keydownHander=function(a){this.dispatchEvent("_keydown",a)},this.keyupHander=function(a){this.dispatchEvent("_keyup",a)},this.addEventListener=function(a,b){return this.messageBus.subscribe(a,b),this},this.dispatchEvent=function(a,b){return this.messageBus.publish(a,b),this}}function c(b){var e,d=this;return this.initialize=function(){c.prototype.initialize.apply(this,arguments),this.nodes=[],this.links=[],this.containers=[],this.selectedElements=[]},this.initialize(b),this.add=function(b){c.prototype.add.call(this,b),b instanceof a.Node?this.nodes.push(b):b instanceof a.Link?this.links.push(b):b instanceof a.Container&&this.containers.push(b)},this.remove=function(a){c.prototype.remove.call(this,a),this.removeFromArray("nodes",a),this.removeFromArray("links",a),this.removeFromArray("containers",a)},this.clear=function(){c.prototype.clear.call(this),this.nodes=[],this.links=[],this.container=[]},e=c.prototype.paintElements,this.paintElements=function(){e.call(this,this.containers),e.call(this,this.links),e.call(this,this.nodes)},this.pushSelected=function(a){a.onSelected(),this.selectedElements.push(a)},this.cancleAllSelected=function(){for(var a=0;a<this.selectedElements.length;a++)this.selectedElements[a].cancleSelected();this.selectedElements=[]},this.notInSelectedNodes=function(a){for(var b=0;b<this.selectedElements.length;b++)if(a===this.selectedElements[b])return!1;return!0},this.updateSelectedNodes=function(){var a,b;for(a=0;a<this.selectedElements.length;a++)b=this.selectedElements[a],b.onSelected();return!0},this.addEventListener("_mousedown",function(b){var i,c=a.util.clone(b),e=c.x,f=c.y,g=d.getelementByXY(e,f);g?(g.onMousedown(c),c.target=g,d.notInSelectedNodes(g)?b.ctrlKey||d.cancleAllSelected():g!=d.currentelement&&d.updateSelectedNodes(e,f),d.pushSelected(g)):("edit"==d.stage.mode&&(d.currentControlRect=d.getControlRectByXY(e,f)),null!=d.currentControlRect?(i=d.currentControlRect.element,i.selectedWidth=i.width,i.selectedHeight=i.height,i.resizeLocation={x:i.x,y:i.y}):b.ctrlKey||d.cancleAllSelected()),d.dispatchEvent("mousedown",c),d.currentelement=g}),this.addEventListener("_click",function(b){var c=a.util.clone(b),e=d.getelementByXY(b.x,b.y);e&&e.onClick(c),d.dispatchEvent("click",c)}),this.addEventListener("_dbclick",function(b){var c=a.util.clone(b),e=c.x,f=c.y,g=d.getelementByXY(e,f);g?(g.onDbclick(c),c.target=g,d.dispatchEvent("dbclick",c)):(d.cancleAllSelected(),d.dispatchEvent("dbclick",c)),d.currentelement=g}),this.addEventListener("_mousedrag",function(b){var f,g,h,i,j,k,l,m;if(b.x,b.y,f=b.dx,g=b.dy,d.currentelement&&d.currentelement.dragable){for(h=a.util.clone(b),h.dx=f,h.dy=g,h.target=d.currentelement,i=0;i<d.selectedElements.length;i++)j=d.selectedElements[i],j!==d.currentelement&&(k=j.selectedLocation.x+f,l=j.selectedLocation.y+g,j.setLocation(k,l));d.currentelement.onMousedrag(h),d.dispatchEvent("mousedrag",h)}else"edit"==d.stage.mode?(m=d.currentControlRect,null!=m&&m.element.resizeAble&&d.elementResizeHandle(m,f,g)):d.areaSelectHandle(b)}),this.areaSelectHandle=function(a){var i,j,b=a.x,c=a.y,e=b>=d.stage.mouseDownX?d.stage.mouseDownX:b,f=c>=d.stage.mouseDownY?d.stage.mouseDownY:c,g=Math.abs(b-d.stage.mouseDownX),h=Math.abs(c-d.stage.mouseDownY);for(d.clearOperations().addOperation(function(a){a.beginPath(),a.strokeStyle="rgba(0,0,236,0.5)",a.fillStyle="rgba(0,0,236,0.1)",a.rect(e,f,g,h),a.fill(),a.stroke(),a.closePath()}),i=0;i<d.elements.length;i++)j=d.elements[i],j.x>e&&j.x+j.width<e+g?j.y>f&&j.y+j.height<f+h&&d.pushSelected(j):a.ctrlKey||j.cancleSelected()},this.addEventListener("_mousemove",function(b){var g,h,c=b.x,e=b.y,f=d.getelementByXY(c,e);f?(d.mouseOverelement&&d.mouseOverelement!==f&&d.mouseOverelement.onMouseout(b),d.mouseOverelement=f,f.isOnMousOver||(f.onMouseover(b),g=a.util.clone(b),g.target=f,d.dispatchEvent("mouseover",g))):d.mouseOverelement&&(d.mouseOverelement.onMouseout(b),g=a.util.clone(b),g.target=f,d.dispatchEvent("mouseout",g),d.mouseOverelement=null),h=d.getControlRectByXY(c,e),null!=h&&h.element.resizeAble&&d.setCusorByControlRectPosition(h.position)}),this.elementResizeHandle=function(a,b,c){var f,g,d=a.element,e=a.position;"top_left"==e?(d.width>1&&d.height>1&&(d.x=d.resizeLocation.x+b,d.y=d.resizeLocation.y+c),c=-c,b=-b):"top_center"==e?(d.height>1&&(d.y=d.resizeLocation.y+c),c=-c,b=0):"top_right"==e?(d.width>1&&d.height>1&&(d.y=d.resizeLocation.y+c),c=-c):"bottom_left"==e?(d.width>1&&(d.x=d.resizeLocation.x+b),b=-b):"middle_left"==e?(d.width>1&&(d.x=d.resizeLocation.x+b),b=-b,c=0):"bottom_center"==e?b=0:"middle_right"==e&&(c=0),f=d.selectedWidth+b,g=d.selectedHeight+c,0>=f&&(f=1),0>=g&&(g=1),d.width=f,d.height=g},this.setCusorByControlRectPosition=function(a){var b={top_left:"nw-resize",top_center:"n-resize",top_right:"ne-resize",middle_left:"e-resize",middle_right:"e-resize",bottom_left:"ne-resize",bottom_center:"n-resize",bottom_right:"nw-resize"},c=b[a];null!=c&&(this.stage.canvas.style.cursor=c)},this.getControlRectByXY=function(b,c){var d,e,f,g,h,i,j;if(this.selectedElements.length>0)for(d=0;d<this.selectedElements.length;d++){e=this.selectedElements[d],f=this.getElementControlRects(e);for(g in f)if(h=f[g],h.element=e,i={x:e.x+e.width*e.scalaX/2,y:e.y+e.height*e.scalaY/2},j={x:i.x+h.x,y:i.y+h.y,width:h.width,height:h.height},a.util.isPointInRect({x:b,y:c},j))return h}return null},this.addEventListener("_mouseup",function(b){var f,g;b.x,b.y,f=d.currentelement,d.clearOperations(),g=a.util.clone(b),d.currentelement?(d.currentelement.onMouseup(g),g.target=d.currentelement,d.dispatchEvent("mouseup",g)):d.dispatchEvent("mouseup",g),f&&f.layout&&1==f.layout.auto&&d.layoutNode(f)}),this.isAllEndpoint=function(a){var b,c;for(b=0;b<a.length;b++)if(c=this.getChilds(a[b]),c.length>0)return!1;return!0},this.getChilds=function(a){var c,b=[];for(c=0;c<this.links.length;c++)this.links[c].nodeA===a&&b.push(this.links[c].nodeZ);return b},this.layoutNode=function(b){var d,c=this.getChilds(b);if(0==c.length)return null;if(a.Layout.adjustPosition(b,c),this.isAllEndpoint(c))return null;for(d=0;d<c.length;d++)this.layoutNode(c[d]);return null},d}a.AbstractScene=b,c.prototype=new a.AbstractScene,a.Scene=c}(JTopo),function(a){function b(){this.initialize=function(){this.shadow=!0},this.getLocation=function(){return{x:this.x,y:this.y}},this.setLocation=function(a,b){return this.x=a,this.y=b,this},this.setCenterLocation=function(a,b){return this.x=a-this.width/2,this.y=b-this.height/2,this},this.getCenterLocation=this.getCenterXY=function(){return{x:this.x+this.width/2,y:this.y+this.height/2}},this.getSize=function(){return{width:this.width,height:this.heith}},this.setSize=function(a,b){return this.width=a,this.height=b,this},this.setBound=function(a,b,c,d){return this.setLocation(a,b),this.setSize(c,d),this},this.getBound=function(){return{left:this.x,top:this.y,right:this.x+this.width,bottom:this.y+this.height}},this.getDisplaySize=function(){return{width:this.width*this.scalaX,height:this.height*this.scalaY}},this.onSelected=function(){this.selected=!0,this.selectedLocation={x:this.x,y:this.y}},this.cancleSelected=function(){this.selected=!1,this.selectedLocation=null},this.onDbclick=function(a){this.onDbclickX=a.x,this.onDbclickY=a.y,a.target=this,this.dispatchEvent("dbclick",a)},this.onClick=function(a){this.clickX=a.x,this.clickY=a.y,this.onSelected(),a.target=this,this.dispatchEvent("click",a)},this.onMousedown=function(a){this.mousedownX=a.x,this.mousedownY=a.y,this.onSelected(),a.target=this,this.dispatchEvent("mousedown",a)},this.onMouseup=function(a){this.mouseupX=a.x,this.mouseupY=a.y,this.isOnMousedrag=!1,a.target=this,this.dispatchEvent("mouseup",a)},this.onMouseover=function(a){this.isOnMousOver=!0,this.dispatchEvent("mouseover",a)},this.onMouseout=function(a){this.isOnMousOver=!1,a.target=this,this.dispatchEvent("mouseout",a)},this.onMousedrag=function(a){var b,c,d,e;this.isOnMousedrag=!0,b=a.dx,c=a.dy,d=this.selectedLocation.x+b,e=this.selectedLocation.y+c,this.setLocation(d,e),a.target=this,this.dispatchEvent("mousedrag",a)},this.paint=function(a){a.beginPath(),a.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",a.rect(-this.width/2,-this.height/2,this.width,this.height),a.fill(),a.closePath()},this.addEventListener=function(b,c){return this.messageBus||(this.messageBus=new a.util.MessageBus),this.messageBus.subscribe(b,c),this},this.dispatchEvent=function(a,b){return this.messageBus?(this.messageBus.publish(a,b),this):null}}function c(){this.initialize=function(){c.prototype.initialize.apply(this,arguments),this.x=0,this.y=0,this.width=32,this.height=32,this.visible=!0,this.translate=!0,this.alpha=1,this.rotate=0,this.scalaX=1,this.scalaY=1,this.style={fillStyle:"22,119,238"},this.editable=!0,this.resizeAble=!0},this.initialize(arguments)}function d(a,b){this.initialize(),this.style.background="auto-size";var c=d.imageChace;null==c&&(c=d.imageChace={}),this.setImage=function(a,b){var e,d=this;"string"==typeof a?(e=c[a],null==e?(e=new Image,e.src=a,b&&(e.onload=function(){c[a]=e,d.setSize(e.width,e.height)})):b&&this.setSize(e.width,e.height),this.image=e):(this.image=a,b&&a&&a.width&&a.height&&this.setSize(a.width,a.height))},a&&this.setImage(a,b),this.paint=function(a){this.image&&(a.save(),a.beginPath(),a.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",this.paintImage(a),a.fill(),a.closePath(),a.restore())},this.paintImage=function(a){a.drawImage(this.image,-this.width/2,-this.height/2,this.width,this.height)}}function e(a){this.initialize(),this.paint=a}c.prototype=new b,d.prototype=new c,e.prototype=new c,a.AbstractElement=b,a.Element=c,a.ImageElement=d,a.CustomElement=e}(JTopo),function(a){function b(a){this.initialize=function(a){b.prototype.initialize.apply(this,arguments),this.style.fontColor="255,255,255",this.style.fontSize="10pt",this.style.font="Consolas",this.name=a,this.dragable=!0,this.selectable=!0,this.selected=!1,this.label={position:"Bottom_Center"}},this.initialize(a),this.paint=function(a){(this.selected||this.isOnMousOver)&&this.drawSelectedRect(a),this.image?b.prototype.paint.call(this,a):(a.beginPath(),a.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",a.rect(-this.width/2,-this.height/2,this.width,this.height),a.fill(),a.closePath()),this.drawText(a)},this.drawSelectedRect=function(a){var b,c,d,e;this.selectable&&(b=this.name,c=b?a.measureText(b).width:0,d=b?16:6,e=Math.max(this.width,c),a.save(),a.beginPath(),a.strokeStyle="rgba(168,202,255, 0.9)",a.fillStyle="rgba(168,202,236,0.7)",a.rect(-e/2-3,-this.height/2-3,e+6,this.height+d),a.fill(),a.stroke(),a.closePath(),a.restore())},this.drawText=function(a){var c,d,b=this.name;b&&""!=b&&(c=a.measureText(b).width,a.beginPath(),a.font=this.style.fontSize+" "+this.style.font,a.strokeStyle="rgba("+this.style.fontColor+", "+this.alpha+")",d=this.getTextPostion(this.label.position,c),a.strokeText(b,d.x,d.y),a.closePath())},this.getTextPostion=function(a,b){var e,c={Top_Center:function(){return{x:-this.width/2+(this.width-b)/2,y:-this.height/2}},Top_Right:function(){return{x:this.width/2,y:-this.height/2}},Top_Left:function(){return{x:-this.width/2-b,y:-this.height/2}},Bottom_Center:function(){return{x:-this.width/2+(this.width-b)/2,y:this.height/2+12}},Bottom_Right:function(){return{x:this.width/2,y:this.height/2+12}},Bottom_Left:function(){return{x:-this.width/2-b,y:this.height/2+12}},Middle_Center:function(){return{x:-this.width/2+(this.width-b)/2,y:0}},Middle_Right:function(){return{x:this.width/2,y:0}},Middle_Left:function(){return{x:-this.width/2-b,y:0}}},d=c[a];return null==d&&(d=c.Bottom_Center),e=d.call(this),this.label.offsetX&&"number"==typeof this.label.offsetX&&(e.x+=this.label.offsetX),this.label.offsetY&&"number"==typeof this.label.offsetY&&(e.y+=this.label.offsetY),e}}function c(a){this.initialize(),this.height=14,this.name=a,this.paint=function(a){var b=a.measureText(this.name).width;this.width=b,a.beginPath(),a.font=this.style.fontSize+" "+this.style.font,a.strokeStyle="rgba("+this.style.fontColor+", "+this.alpha+")",a.strokeText(this.name,-this.width/2,-this.height/2+12),a.closePath()}}function d(a){this.initialize(),this.setSize(100,100),this.name=a,this.translate=!1,this.paint=function(a){var b,c;this.visible&&(b=this.x,c=this.y,a.beginPath(),a.strokeStyle="rgba(230, 230, 230, 0.8)",a.moveTo(b+50,c),a.quadraticCurveTo(b,c,b,c+37.5),a.quadraticCurveTo(b,c+75,b+25,c+75),a.quadraticCurveTo(b+25,c+95,b+5,c+100),a.quadraticCurveTo(b+35,c+95,b+45,c+75),a.quadraticCurveTo(b+100,c+75,b+100,c+37.5),a.quadraticCurveTo(b+100,c,b+50,c),a.strokeText(this.name,this.x+20,this.y+20),a.stroke(),a.closePath())}}function e(){this.initialize(),this.setSize(120,120),this.translate=!1,this.paint=function(a){this.visible&&(a.save(),a.beginPath(),a.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",a.moveTo(this.x+75,this.y+40),a.bezierCurveTo(this.x+75,this.y+37,this.x+70,this.y+25,this.x+50,this.y+25),a.bezierCurveTo(this.x+20,this.y+25,this.x+20,this.y+62.5,this.x+20,this.y+62.5),a.bezierCurveTo(this.x+20,this.y+80,this.x+40,this.y+102,this.x+75,this.y+120),a.bezierCurveTo(this.x+110,this.y+102,this.x+130,this.y+80,this.x+130,this.y+62.5),a.bezierCurveTo(this.x+130,this.y+62.5,this.x+130,this.y+25,this.x+100,this.y+25),a.bezierCurveTo(this.x+85,this.y+25,this.x+75,this.y+37,this.x+75,this.y+40),a.fill(),a.closePath(),a.restore())}}function f(a){this.initialize(),this.style.fillStyle="71, 167, 184",this.className=a,this.rowHeight=18,this.width=268,this.classObj=null,this.translate=!1,this.operations=null,this.attributes=null,this.maxItem=10,this.paint=function(a){var b,c,d,e,f,g,h,i;if(this.visible){if(null!=this.classObj){this.operations=[],this.attributes=[];for(b in this.classObj){if(e>this.maxItem)break;if(c=this.classObj[b],"function"==typeof c){for(d="(",e=0;e<c.length;e++)d+="arg"+e,e+1<c.length&&(d+=", ");d+=")",b.length+d.length>35?(this.operations.push("+ "+b+d.substring(0,35-b.length)),this.operations.push("  "+d.substring(35-b.length))):this.operations.push("+ "+b+d)}else this.attributes.push("- "+b+": "+typeof c)}}for((null==this.operations||0==this.operations.length)&&(this.operations=[" "]),(null==this.attributes||0==this.attributes.length)&&(this.attributes=[" "]),this.operations.length>this.maxItem&&(this.operations=this.operations.splice(0,this.maxItem),this.operations.push("  ...")),this.attributes.length>this.maxItem&&(this.attributes=this.attributes.splice(0,this.maxItem),this.attributes.push("  ...")),this.height=(this.operations.length+this.attributes.length+1)*this.rowHeight+3,a.save(),a.beginPath(),a.fillStyle="rgba(239,247,149,"+this.alpha+")",a.rect(this.x,this.y,this.width,this.height),a.shadowBlur=0,a.shadowOffsetX=0,a.shadowOffsetY=0,a.fill(),a.font=this.style.fontSize+" "+this.style.font,a.moveTo(this.x,this.y+this.rowHeight+3),a.lineTo(this.x+this.width,this.y+this.rowHeight+3),f=a.measureText(this.className).width,a.strokeText(this.className,this.x+(this.width-f)/2,this.y+this.rowHeight),e=0;e<this.operations.length;e++)g=this.operations[e],a.strokeText(g,this.x+5,this.y+this.rowHeight+this.rowHeight*(e+1));for(a.moveTo(this.x,this.y+this.rowHeight*(this.operations.length+1)+3),a.lineTo(this.x+this.width,this.y+this.rowHeight*(this.operations.length+1)+3),h=this.y+this.rowHeight*(this.operations.length+1),e=0;e<this.attributes.length;e++)i=this.attributes[e],a.strokeText(i,this.x+5,h+this.rowHeight*(e+1));a.stroke(),a.closePath(),a.restore()}}}function g(a){this.width=-1,this.height=-1,this.initialize(),this.radius=30,this.beginDegree=0,this.endDegree=2*Math.PI,this.name=a,this.paint=function(a){var b,c,d;(this.selected||this.isOnMousOver)&&this.drawSelectedRect(a),0!=this.visible&&((-1==this.width||-1==this.height)&&(b=2*this.radius,c=2*this.radius,this.width=b,this.height=c),d=Math.min(this.width/2,this.height/2),a.save(),a.beginPath(),a.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",a.arc(0,0,d,this.beginDegree,this.endDegree,!0),a.fill(),a.closePath(),a.restore(),this.drawText(a))}}function h(a,b,c){var d,e;this.initialize(),this.frameImages=a||[],this.frameIndex=0,this.isStop=!0,d=b||1e3,this.repeatPlay=!1,e=this,this.nextFrame=function(){if(!this.isStop&&null!=this.frameImages.length){if(this.frameIndex++,this.frameIndex>=this.frameImages.length){if(!this.repeatPlay)return;this.frameIndex=0}this.setImage(this.frameImages[this.frameIndex],c),setTimeout(function(){e.nextFrame()},d/a.length)}}}function i(a,b,c,d,e){var f,g;this.initialize(),f=this,this.setImage(a),this.frameIndex=0,this.isPause=!0,this.repeatPlay=!1,g=d||1e3,e=e||0,this.paint=function(a){var b,d,f,g;this.image&&(b=this.width,d=this.height,a.save(),a.beginPath(),a.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",f=(Math.floor(this.frameIndex/c)+e)*d,g=Math.floor(this.frameIndex%c)*b,a.drawImage(this.image,g,f,b,d,-b/2,-d/2,b,d),a.fill(),a.closePath(),a.restore())},this.nextFrame=function(){if(!this.isStop){if(this.frameIndex++,this.frameIndex>=b*c){if(!this.repeatPlay)return;this.frameIndex=0}setTimeout(function(){f.isStop||f.nextFrame()},g/(b*c))}}}function j(){var a=null;return a=arguments.length<=3?new h(arguments[0],arguments[1],arguments[2]):new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),a.stop=function(){a.isStop=!0},a.play=function(){a.isStop=!1,a.frameIndex=0,a.nextFrame()},a}b.prototype=new a.ImageElement,c.prototype=new b,d.prototype=new b,e.prototype=new b,f.prototype=new b,g.prototype=new b,h.prototype=new b,i.prototype=new b,j.prototype=new b,a.Node=b,a.TextNode=c,a.UMLClassNode=f,a.TipNode=d,a.HeartNode=e,a.CircleNode=g,a.AnimateNode=j}(JTopo),function(a){function b(a,b,c){this.initialize=function(a,b,c){0!=arguments.length&&(this.name=c,this.nodeA=a,this.nodeZ=b,this.alpha=1,this.style={strokeStyle:"116, 166, 250",fillStyle:"116, 166, 250",lineWidth:2,fontSize:"12pt",fontColor:"255,255,0",lineJoin:"miter"},this.visible=!0)},this.initialize(a,b,c),this.paint=function(c){this.nodeA&&this.nodeZ&&(c.beginPath(),c.strokeStyle="rgba("+this.style.strokeStyle+","+this.alpha+")",c.lineWidth=this.style.lineWidth,a===b?c.arc(this.nodeA.x,this.nodeA.y,a.width/2,0,2*Math.PI):(c.moveTo(this.nodeA.x+this.nodeA.width/2,this.nodeA.y+this.nodeA.height/2),c.lineTo(this.nodeZ.x+this.nodeZ.width/2,this.nodeZ.y+this.nodeZ.height/2)),c.stroke(),c.closePath(),this.paintText(c))},this.paintText=function(a){if(this.name){var b=this.name;if(!b||""==b)return;a.measureText(b).width,a.beginPath(),a.lineWidth=1,a.font=this.style.fontSize+" "+this.style.font,a.strokeStyle="rgba("+this.style.fontColor+", "+this.alpha+")",a.strokeText(b,this.nodeA.x+(this.nodeZ.x-this.nodeA.x)/2,this.nodeA.y+(this.nodeZ.y-this.nodeA.y)/2+12),a.stroke(),a.closePath()}}}function c(a,b,d,e){this.initialize=function(){c.prototype.initialize.apply(this,arguments),this.fold=e||"x"},this.initialize(a,b,d,e),this.paint=function(a){var b,c;this.nodeA&&this.nodeZ&&(b=this.nodeA.getCenterXY(),c=this.nodeZ.getCenterXY(),a.save(),a.beginPath(),a.lineJoin=this.style.lineJoin,a.strokeStyle="rgba("+this.style.strokeStyle+","+this.alpha+")",a.lineWidth=this.style.lineWidth,a.moveTo(b.x,b.y),"y"==this.fold?a.lineTo(b.x,c.y):a.lineTo(c.x,b.y),a.lineTo(c.x,c.y),a.stroke(),a.closePath(),a.restore())}}function d(a,b,c){this.initialize=function(){d.prototype.initialize.apply(this,arguments),this.arrowsSize=20,this.fillArrows=!1},this.initialize(a,b,c),this.paint=function(a){var b,c,d,e,f,g;this.nodeA&&this.nodeZ&&(a.beginPath(),a.strokeStyle="rgba("+this.style.strokeStyle+","+this.alpha+")",a.lineWidth=this.style.lineWidth,a.lineJoin=this.style.lineJoin,b={x:this.nodeA.x+this.nodeA.width/2,y:this.nodeA.y+this.nodeA.height/2},c={x:this.nodeZ.x+this.nodeZ.width/2,y:this.nodeZ.y+this.nodeZ.height/2},d=Math.atan2(b.y-c.y,b.x-c.x),c.x=c.x+Math.cos(d)*this.nodeZ.width/2,c.y=c.y+Math.sin(d)*this.nodeZ.height/2,e=.4,f={x:c.x+Math.cos(d-e)*this.arrowsSize,y:c.y+Math.sin(d-e)*this.arrowsSize},g={x:c.x+Math.cos(d+e)*this.arrowsSize,y:c.y+Math.sin(d+e)*this.arrowsSize},a.moveTo(this.nodeA.x+this.nodeA.width/2,this.nodeA.y+this.nodeA.height/2),a.lineTo(f.x+(g.x-f.x)/2,f.y+(g.y-f.y)/2),a.stroke(),a.closePath(),a.beginPath(),a.moveTo(f.x,f.y),a.lineTo(c.x,c.y),a.lineTo(g.x,g.y),a.lineTo(f.x,f.y),1==this.fillArrows&&(a.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",a.fill()),a.stroke(),a.closePath())}}function e(a,b,c,d){this.initialize=function(){e.prototype.initialize.apply(this,arguments),this.arrowsSize=20,this.fillArrows=!1,this.fold=d||"x"},this.initialize(a,b,c,d),this.paint=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;this.nodeA&&this.nodeZ&&(b=this.nodeA.x,c=this.nodeA.y,d=this.nodeZ.x,e=this.nodeZ.y,f=b,g=c,b==d||c==e?(a.beginPath(),a.strokeStyle="rgba("+this.style.strokeStyle+","+this.alpha+")",a.lineWidth=this.style.lineWidth,a.lineJoin=this.style.lineJoin,h={x:this.nodeA.x+this.nodeA.width/2,y:this.nodeA.y+this.nodeA.height/2},i={x:this.nodeZ.x+this.nodeZ.width/2,y:this.nodeZ.y+this.nodeZ.height/2},j=Math.atan2(h.y-i.y,h.x-i.x),i.x=i.x+Math.cos(j)*this.nodeZ.width/2,i.y=i.y+Math.sin(j)*this.nodeZ.height/2,k=.4,l={x:i.x+Math.cos(j-k)*this.arrowsSize,y:i.y+Math.sin(j-k)*this.arrowsSize},m={x:i.x+Math.cos(j+k)*this.arrowsSize,y:i.y+Math.sin(j+k)*this.arrowsSize},a.lineTo(l.x+(m.x-l.x)/2,l.y+(m.y-l.y)/2),a.stroke(),a.closePath(),a.beginPath(),a.moveTo(l.x,l.y),a.lineTo(i.x,i.y),a.lineTo(m.x,m.y),a.lineTo(l.x,l.y),1==this.fillArrows&&(a.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",a.fill()),a.closePath(),a.stroke()):("x"==this.fold?f=b+(d-b):g=c+(e-c),a.beginPath(),a.strokeStyle="rgba("+this.style.strokeStyle+","+this.alpha+")",a.lineWidth=this.style.lineWidth,a.lineJoin=this.style.lineJoin,a.moveTo(b+this.nodeA.width/2,c+this.nodeA.height/2),a.lineTo(f+this.nodeA.width/2,g+this.nodeA.height/2),h={x:f+this.nodeA.width/2,y:g+this.nodeA.height/2},i={x:this.nodeZ.x+this.nodeZ.width/2,y:this.nodeZ.y+this.nodeZ.height/2},j=Math.atan2(h.y-i.y,h.x-i.x),i.x=i.x+Math.cos(j)*this.nodeZ.width/2,i.y=i.y+Math.sin(j)*this.nodeZ.height/2,k=.4,l={x:i.x+Math.cos(j-k)*this.arrowsSize,y:i.y+Math.sin(j-k)*this.arrowsSize},m={x:i.x+Math.cos(j+k)*this.arrowsSize,y:i.y+Math.sin(j+k)*this.arrowsSize},a.lineTo(l.x+(m.x-l.x)/2,l.y+(m.y-l.y)/2),a.stroke(),a.closePath(),a.beginPath(),a.moveTo(l.x,l.y),a.lineTo(i.x,i.y),a.lineTo(m.x,m.y),a.lineTo(l.x,l.y),1==this.fillArrows&&(a.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",a.fill()),a.stroke(),a.closePath()))
}}function f(a,b,c){this.initialize=function(){e.prototype.initialize.apply(this,arguments),this.flexional={direction:"vertical",extend:function(){return 20}}},this.initialize(a,b,c);var d=this.paintText;this.paint=function(a){var b,c,e,f,g,h;this.nodeA&&this.nodeZ&&(b=this.nodeA.x,c=this.nodeA.y,e=this.nodeZ.x,f=this.nodeZ.y,a.beginPath(),a.lineJoin=this.style.lineJoin,a.strokeStyle="rgba("+this.style.strokeStyle+","+this.alpha+")",a.lineWidth=this.style.lineWidth,b==e||c==f?(a.moveTo(this.nodeA.x+this.nodeA.width/2,this.nodeA.y+this.nodeA.height/2),a.lineTo(this.nodeZ.x+this.nodeZ.width/2,this.nodeZ.y+this.nodeZ.height/2)):(g="horizontal"==this.flexional.direction?this.flexional.extend():0,h="vertical"==this.flexional.direction?this.flexional.extend():0,g*=e-b>0?1:-1,h*=f-c>0?1:-1,a.moveTo(b+this.nodeA.width/2,c+this.nodeA.height/2),a.lineTo(b+this.nodeA.width/2+g,c+this.nodeA.height/2+h),a.lineTo(e+this.nodeA.width/2-g,f+this.nodeA.height/2-h),a.lineTo(e+this.nodeA.width/2,f+this.nodeA.height/2)),a.stroke(),a.closePath(),d.call(this,a))}}function g(a,b,c){this.initialize=function(){e.prototype.initialize.apply(this,arguments)},this.initialize(a,b,c),this.flexional.extend=function(){return"horizontal"==this.flexional.direction?Math.abs(b.x-a.x)/2:Math.abs(b.y-a.y)/2}}b.prototype=new a.AbstractElement,c.prototype=new b,d.prototype=new b,e.prototype=new b,f.prototype=new b,g.prototype=new f,a.Link=b,a.FoldLink=c,a.ArrowsLink=d,a.ArrowsFoldLink=e,a.FlexionalLink=f,a.OrthogonalLink=g}(JTopo),function(a){function b(c){this.initialize=function(a){b.prototype.initialize.apply(this,null),this.name=a,this.x=0,this.y=0,this.width=100,this.height=100,this.items=[],this.style={fillStyle:"255, 255, 255"},this.alpha=.6,this.dragable=!0,this.childDragble=null,this.visible=!0},this.initialize(c),this.add=function(a){this.items.push(a),a.parentContainer=this,this.updateBound(),this.childDragble&&(a.dragable=this.childDragble)},this.remove=function(a){for(var b=0;b<this.items.length;b++)if(this.items[b]===a){a.parentContainer=null,this.items=this.items.del(b),a.lastParentContainer=this;break}},this.clear=this.removeAll=function(){for(var a=0;a<this.items.length;a++)this.remove(this.items[a])},this.setLocation=function(a,b){var e,f,c=a-this.x,d=b-this.y;for(this.x=a,this.y=b,e=0;e<this.items.length;e++)f=this.items[e],f.setLocation(f.x+c,f.y+d)},this.updateBound=function(){var a,b;for(a=0;a<this.items.length;a++)b=this.items[a],b.x<this.x&&(b.x=this.x),b.y<this.y&&(b.y=this.y),b.x+b.width>this.x+this.width&&(b.x=this.x+this.width-b.width),b.y+b.height>this.y+this.height&&(b.y=this.y+this.height-b.height)},this.paint=function(b){this.layout&&a.Layout.adjustPosition(this,this.items),this.updateBound(),this.visible&&(b.beginPath(),b.shadowBlur=9,b.shadowColor="rgba(0,0,0,0.5)",b.shadowOffsetX=3,b.shadowOffsetY=3,b.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",b.fillRect(this.x,this.y,this.width,this.height),b.closePath())}}function c(){this.initialize(arguments),this.updateBound=function(){var b,c,d,e,f,g,h,i;if(this.items.length>0){for(b=1e7,c=-1e7,d=1e7,e=-1e7,f=c-b,g=e-d,h=0;h<this.items.length;h++)i=this.items[h],i.x<=b&&(b=i.x),i.x>=c&&(c=i.x),i.y<=d&&(d=i.y),i.y>=e&&(e=i.y),f=c-b+i.width,g=e-d+i.height;this.x=b,this.y=d,this.width=f,this.height=g}}}function d(){this.initialize(arguments),this.paint=function(a){var b,c,d;if(!(this.items.length<2)){for(b=[],c=0;c<this.items.length;c++)d=this.items[c].getCenterXY(),b.push(d);for(c=0;c<b.length-2;c+=3)a.beginPath(),a.moveTo(b[c].x,b[c].y),this.items[c+1].style.fillStyle="0,255,0",a.quadraticCurveTo(b[c+1].x,b[c+1].y,b[c+2].x,b[c+2].y),a.stroke(),a.closePath(),a.save(),a.beginPath(),a.lineWidth=1,a.strokeStyle="rgba(0,255,0,0.3)",a.moveTo(b[c].x,b[c].y),a.lineTo(b[c+1].x,b[c+1].y),a.stroke(),a.closePath(),a.restore()}}}b.prototype=new a.AbstractElement,c.prototype=new b,d.prototype=new b,a.Container=b,a.AutoSizeContainer=c,a.EditContainer=d}(JTopo),function(a){function b(a,b,c,d,e,f){var l,m,n,g=e?e:0,h=f?f:2*Math.PI,i=h-g,j=i/c,k=[];for(g+=j/2,l=g;h>=l;l+=j)m=a+Math.cos(l)*d,n=b+Math.sin(l)*d,k.push({x:m,y:n});return k}function c(a,b,c,d,e,f){var i,j,g=f||"bottom",h=[];if("bottom"==g)for(i=a-c/2*d+d/2,j=0;c>=j;j++)h.push({x:i+j*d,y:b+e});else if("top"==g)for(i=a-c/2*d+d/2,j=0;c>=j;j++)h.push({x:i+j*d,y:b-e});else if("right"==g)for(i=b-c/2*d+d/2,j=0;c>=j;j++)h.push({x:a+e,y:i+j*d});else if("left"==g)for(i=b-c/2*d+d/2,j=0;c>=j;j++)h.push({x:a-e,y:i+j*d});return h}function e(a,b,c,d,e,f){var h,i,g=[];for(h=0;c>h;h++)for(i=0;d>i;i++)g.push({x:a+i*e,y:b+h*f});return g}function f(a,d){var f,g,h,i,j;if(a.layout){if(f=a.layout,g=f.type,h=null,i=a.getCenterXY(),"star"==g)h=b(i.x,i.y,d.length,a.layout.radius,a.layout.beginDegree,a.layout.endDegree);else if("tree"==g)h=c(i.x,i.y,d.length,f.width,f.height,f.direction);else{if("grid"!=g)return;h=e(i.x,i.y,f.rows,f.cols,f.horizontal||0,f.vertical||0)}for(j=0;j<d.length;j++)d[j].setCenterLocation(h[j].x,h[j].y)}}a.Layout={adjustPosition:f}}(JTopo),function(a){function b(){var b=new a.CircleNode;return b.radius=150,b.colors=["#3666B0","#2CA8E0","#77D1F6"],b.datas=[.3,.3,.4],b.translate=!1,b.paint=function(a){var e,f,g,c=2*b.radius,d=2*b.radius;for(b.width=c,b.height=c,e=0,f=0;f<this.datas.length;f++)g=2*this.datas[f]*Math.PI,a.beginPath(),a.fillStyle=b.colors[f],a.moveTo(this.x+c/2,this.y+d/2),a.arc(this.x+c/2,this.y+d/2,this.radius/2,e,e+g,!1),a.fill(),a.closePath(),e+=g},b}a.PieChartNode=b}(JTopo),function(a){function b(b,c){var e,d=null;return{stop:function(){return e?(window.clearInterval(e),d&&d.publish("stop"),this):this},start:function(){var a=this;return e=setInterval(function(){b.call(a)},c),this},onStop:function(b){return null==d&&(d=new a.util.MessageBus),d.subscribe("stop",b),this}}}function c(a,c){var d,e,f,g,h,i;return c=c||{},d=c.gravity||.1,e=c.dx||0,f=c.dy||5,g=c.stop,h=c.interval||30,i=new b(function(){g&&g()?(f=.5,this.stop()):(f+=d,a.setLocation(a.x+e,a.y+f))},h)}function d(a,c,d,e,f){var i,j,k,l,g=50,h={};for(i in c)j=c[i],k=j-a[i],h[i]={oldValue:a[i],targetValue:j,step:k/d*g,isDone:function(b){var c=this.step>0&&a[b]>=this.targetValue||this.step<0&&a[b]<=this.targetValue;return c}};return l=new b(function(){var d,g,b=!0;for(d in c)h[d].isDone(d)||(a[d]+=h[d].step,b=!1);if(b){if(!e)return this.stop();for(d in c)f?(g=h[d].targetValue,h[d].targetValue=h[d].oldValue,h[d].oldValue=g,h[d].step=-h[d].step):a[d]=h[d].oldValue}},g)}function e(b,c){function f(c,e,f,g,h){var i=new a.Node;return i.setImage(b.image),i.setSize(b.width,b.height),i.style=d,i.setLocation(c,e),i.paint=function(a){a.save(),a.arc(0,0,f,g,h),a.clip(),a.beginPath(),null!=this.image?a.drawImage(this.image,-this.width/2,-this.height/2):(a.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",a.rect(this.x,this.y,this.width,this.height),a.fill()),a.closePath(),a.restore()},i}var d=b.style,e=c.angle,g=e,h=e+Math.PI,i=f(b.x,b.y,b.width,g,h),j=f(b.x,b.y,b.width,g+Math.PI,g);return[i,j]}a.Animate={},a.Effect={},a.Animate.gravity=c,a.Animate.stepByStep=d,a.Effect.splitTwoPiece=e}(JTopo);
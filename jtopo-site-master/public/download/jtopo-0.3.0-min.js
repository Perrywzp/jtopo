(function(e){JTopo={version:"0.3.0"},e.JTopo=JTopo})(window),function(e){function t(e){function n(e,n){var r=[],i=0;for(var s=0;s<e.length;s++){var o=e[s],u=t.messageMap[o];u==null&&(t.messageMap[o]=[]);function a(t){return r[s]=t,i++,i==e.length?(i=0,n.apply(null,r)):null}t.messageMap[o].push(a),t.messageCount++}}var t=this;this.name=e,this.messageMap={},this.messageCount=0,this.subscribe=function(e,r){if(!typeof e=="string")n(e,r);else{var i=t.messageMap[e];i==null&&(t.messageMap[e]=[]),t.messageMap[e].push(r),t.messageCount++}},this.unsubscribe=function(e){var n=t.messageMap[e];n!=null&&(t.messageMap[e]=null,delete t.messageMap[e],t.messageCount--)},this.publish=function(e,n,r){var i=t.messageMap[e];if(i!=null)for(var s=0;s<i.length;s++)r?function(e,t){setTimeout(function(){e(t)},10)}(i[s],n):i[s](n)}}function n(e,t){var n=t.x-e.x,r=t.y-e.y;return Math.sqrt(n*n+r*r)}function r(e){return e.pageX||e.pageY?{x:e.pageX,y:e.pageY}:{x:e.clientX+document.body.scrollLeft-document.body.clientLeft,y:e.clientY+document.body.scrollTop-document.body.clientTop}}function i(e){e=e||r(window.event);var t=document.body.scrollLeft+(e.x||e.layerX),n=document.body.scrollTop+(e.y||e.layerY);return{x:t,y:n}}function s(e,t,n,r,i){var s=n-e,o=r-t,u=Math.sqrt(s*s+o*o),a=Math.atan2(o,s)+i;return{x:e+Math.cos(a)*u,y:t+Math.sin(a)*u}}function o(e,t,n){var r=[];for(var i=0;i<t.length;i++){var o=s(e.x,e.y,t[i].x,t[i].y,n);r.push(o)}return r}function u(e,t,n){function i(r){if(r==e.length)return;t(e[r]),setTimeout(function(){i(++r)},n)}if(e.length==0)return;var r=0;i(r)}function a(e,t,n,r){function s(e){if(e==t)return;n(t),setTimeout(function(){s(++e)},r)}if(t<e)return;var i=0;s(i)}Array.prototype.del=function(e){if(typeof e!="number"){for(var t=0;t<this.length;t++)if(this[t]===e)return this.slice(0,t).concat(this.slice(t+1,this.length));return this}return e<0?this:this.slice(0,e).concat(this.slice(e+1,this.length))},[].indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),window.console||(window.console={log:function(e){},info:function(e){},debug:function(e){},warn:function(e){},error:function(e){}}),e.util={rotatePoint:s,rotatePoints:o,getDistance:n,getXY:i,mouseCoords:r,MessageBus:t,isIE:!+[1]},window.$for=a,window.$foreach=u}(JTopo),function(e){function t(t){var n=this;this.initialize=function(t){this.scenes=[],this.width=0,this.height=0,this.frames=16,this.messageBus=new e.util.MessageBus,this.currentScene=null,this.setCanvas(t)},this.setCanvas=function(e){if(!e)return;this.canvas=arguments[0],this.width=e.width,this.height=e.height,this.graphics=e.getContext("2d"),this.offsetX=e.offsetLeft,this.offsetY=e.offsetTop},this.initialize(t),this.canvas.onmousedown=function(t){var r=e.util.getXY(t);n.dispatchEvent("mousedown",{x:r.x-this.offsetX,y:r.y-n.offsetY}),n.currentScene&&n.currentScene.mousedown({x:r.x-n.offsetX,y:r.y-n.offsetY})},this.canvas.onmousemove=function(t){var r=e.util.getXY(t);n.dispatchEvent("mousemove",{x:r.x-n.offsetX,y:r.y-n.offsetY}),n.currentScene&&n.currentScene.mousemove({x:r.x-n.offsetX,y:r.y-n.offsetY})},this.canvas.onmouseup=function(t){var r=e.util.getXY(t);n.dispatchEvent("mouseup",{x:r.x-n.offsetX,y:r.y-n.offsetY}),n.currentScene&&n.currentScene.mouseup({x:r.x-n.offsetX,y:r.y-n.offsetY})};try{window.addEventListener("keydown",function(e){var t=e.keyCode?e.keyCode:e.which;t===17,t===18,t===16,t===27,t===38||t===87,t===39||t===68,t===40||t===83,t===37||t===65,n.dispatchEvent("keydown",{key:t,event:e}),n.currentScene&&n.currentScene.keydown({key:t,event:e})},!0),window.addEventListener("keyup",function(e){var t=e.keyCode?e.keyCode:e.which;n.dispatchEvent("keyup",{keyCode:t,event:e}),n.currentScene&&n.currentScene.keyup({keyCode:t,event:e})},!0)}catch(r){}this.play=function(e){return this.currentScene&&this.currentScene.hide(),window.scene=this.currentScene=e,e.show(),this},this.addEventListener=function(e,t){return this.messageBus.subscribe(e,t),this},this.dispatchEvent=function(e,t){return this.messageBus.publish(e,t),this},this.saveImageInfo=function(){var e=this.canvas.toDataURL("image/png"),t=window.open("about:blank","image from canvas");t.document.write("<img src='"+e+"' alt='from canvas'/>")},this.saveAsLocalImage=function(){var e=this.canvas.toDataURL("image/png").replace("image/png","image/octet-stream");window.location.href=e},function(){n.currentScene&&n.currentScene.updateView(),setTimeout(arguments.callee,1e3/n.frames)}()}e.Stage=t}(JTopo),function(e){function t(t){this.initialize=function(t){this.visible=!1,this.rotate=0,this.alpha=1,this.eagleEye={width:180,height:120,visible:!1,translate:{x:0,y:0}},this.elements=[],this.elementMap={},this.messageBus=new e.util.MessageBus,this.background=null,this.style={fillStyle:"238,238,238"},this.shadow=!0,this.operations=[],this.setStage(t)},this.setStage=function(e){if(!e)return;e.scenes.push(this),this.stage=e,this.width=e.width,this.height=e.height,this.graphics=e.graphics},this.initialize(t),this.show=function(){this.visible=!0,this.paint()},this.hide=function(){this.visible=!1},this.clear=function(){this.elements=[],this.operations=[]},this.paintElements=function(e){var t=this.graphics;for(var n=0;n<e.length;n++){var r=e[n];t.save();if(r.translate){var i=r.scalaX||1,s=r.scalaY||1;t.translate(r.x+r.width*i/2,r.y+r.height*s/2),r.rotate&&t.rotate(r.rotate),r.scalaX&&r.scalaY?t.scale(r.scalaX,r.scalaY):r.scalaX?t.scale(r.scalaX,1):r.scalaY&&t.scale(1,r.scalaY)}r.paint(t),t.restore()}},this.paintOperations=function(e){for(var t=0;t<e.length;t++)e[t](this.graphics)},this.addOperation=function(e){return this.operations.push(e),this},this.clearOperations=function(){return this.operations=[],this};var n={};this.setBackground=function(e){if(typeof e=="string"){var t=n[e];t==null&&(t=new Image,t.src=e,n[e]=t),this.background=t}else this.background=e},this.paintBackgroud=function(e){this.graphics.save(),this.graphics.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",this.graphics.fillRect(-this.eagleEye.translate.x,-this.eagleEye.translate.y,this.width,this.height),this.background&&this.graphics.drawImage(e,0-this.eagleEye.translate.x,0-this.eagleEye.translate.y,this.width,this.height),this.graphics.restore()},this.paint=function(){if(!this.visible)return;this.graphics.clearRect(0,0,this.width,this.height);var t=this.graphics;t.save(),this.shadow&&(this.graphics.shadowBlur=5,this.graphics.shadowColor="rgba(0,0,0,0.5)",this.graphics.shadowOffsetX=3,this.graphics.shadowOffsetY=6);var n=null;this.eagleEye.visible&&!e.util.isIE&&(n=this.getEagleEyeImage(this.eagleEye.width,this.eagleEye.height),t.translate(this.eagleEye.translate.x,this.eagleEye.translate.y)),this.paintBackgroud(this.background),this.paintElements(this.elements),this.paintOperations(this.operations),this.eagleEye.visible&&n!=null&&!e.util.isIE&&t.putImageData(n,this.width-this.eagleEye.width,this.height-this.eagleEye.height),t.restore()},this.getEagleEyeImage=function(e,t){var n=this.getBound();this.graphics.clearRect(0,0,this.width,this.height);var r=e/n.width,i=t/n.height,s=this.graphics;s.save(),r>1&&(r=1),i>1&&(i=1);if(r==1&&i==1)return null;this.graphics.save(),this.graphics.fillStyle="rgba(0,255,0,0.3)",this.graphics.fillRect(0,0,this.width,this.height),this.graphics.restore(),s.translate(-n.x*r,-n.y*i),s.scale(r,i),this.paintElements(this.elements),this.paintOperations(this.operations);var o=s.getImageData(0,0,e,t);return s.restore(),o},this.getBound=function(){var e={x:999999,y:9999999,width:0,height:0};if(this.elements.length>0){var t=9999999,n=-9999999,r=9999999,i=-9999999,s=n-t,o=i-r;for(var u=0;u<this.elements.length;u++){var a=this.elements[u];a.x<=t&&(t=a.x),a.x>=n&&(n=a.x),a.y<=r&&(r=a.y),a.y>=i&&(i=a.y),s=n-t+(a.width||a.radius||100),o=i-r+(a.height||a.radius||100)}e.x=t-10,e.y=r-10,e.width=s,e.height=o}return e},this.updateView=function(){this.paint()},this.add=function(e){e.id||(e.id="id_"+(new Date).getTime()+this.elements.length),this.elementMap[e.id]||(this.elementMap[e.id]=e,this.elements.push(e))},this.remove=function(e){},this.getelementByXY=function(e,t){var n=null;for(var r=this.elements.length-1;r>=0;r--){var i=this.elements[r];if(i.translate){if(e>i.x&&e<i.x+i.width*i.scalaX&&t>i.y&&t<i.y+i.height*i.scalaY){n=i;break}}else if(e>i.x&&e<i.x+i.width&&t>i.y&&t<i.y+i.height){n=i;break}}return n},this.updateEyeView=function(e,t){var n=this.getBound();this.eagleEye.translate.x=(this.eagleEye.width-(this.width-e))/this.eagleEye.width,this.eagleEye.translate.y=(this.eagleEye.height-(this.height-t))/this.eagleEye.height,this.eagleEye.translate.x*=-n.width,this.eagleEye.translate.y*=-n.height,this.eagleEye.translate.x+=this.width/2,this.eagleEye.translate.y+=this.height/2},this.mousedown=function(e){this.isOnMouseDown=!0;var t=e.x,n=e.y;this.mouseDownX=t,this.mouseDownY=n,this.eagleEye.visible&&t>this.width-this.eagleEye.width&&n>this.height-this.eagleEye.height?this.updateEyeView(t,n):this.dispatchEvent("onMousedown",{x:t-this.eagleEye.translate.x,y:n-this.eagleEye.translate.y,scene:this})},this.mousemove=function(e){var t=e.x,n=e.y;if(this.isOnMouseDown)if(this.eagleEye.visible&&t>this.width-this.eagleEye.width&&n>this.height-this.eagleEye.height)this.updateEyeView(t,n);else{var r=t-this.mouseDownX,i=n-this.mouseDownY;this.dispatchEvent("onMousedrag",{x:t-this.eagleEye.translate.x,y:n-this.eagleEye.translate.y,dx:r,dy:i,scene:this})}else this.dispatchEvent("onMousemove",{x:t-this.eagleEye.translate.x,y:n-this.eagleEye.translate.y,scene:this})},this.mouseup=function(e){var t=e.x,n=e.y;this.isOnMouseDown=!1,this.dispatchEvent("onMouseup",{x:t,y:n,scene:this})},this.keydown=function(e){this.dispatchEvent("onKeydown",e)},this.keyup=function(e){this.dispatchEvent("onKeyup",e)},this.addEventListener=function(e,t){return this.messageBus.subscribe(e,t),this},this.dispatchEvent=function(e,t){return e=="onMousedown"&&(console.log(e),console.log(t)),this.messageBus.publish(e,t),this}}function n(t){var r=this;this.initialize=function(e){n.prototype.initialize.apply(this,arguments),this.nodes=[],this.links=[],this.containers=[],this.otherelements=[],this.selectedElements=[]},this.initialize(t),this.add=function(t){n.prototype.add.call(this,t),t instanceof e.Node?this.nodes.push(t):t instanceof e.Link?this.links.push(t):t instanceof e.Container&&this.containers.push(t)},this.remove=function(e){n.prototype.remove.call(this,e)},this.clear=function(){n.prototype.clear.call(this),this.nodes=[],this.links=[],this.container=[],this.otherelements=[]};var i=n.prototype.paintElements;return this.paintElements=function(){i.call(this,this.containers),i.call(this,this.links),i.call(this,this.nodes)},this.pushSelected=function(e){e.onSelected(),this.selectedElements.push(e)},this.cancleAllSelected=function(){for(var e=0;e<this.selectedElements.length;e++)this.selectedElements[e].cancleSelected();this.selectedElements=[]},this.notInSelectedNodes=function(e){for(var t=0;t<this.selectedElements.length;t++)if(e===this.selectedElements[t])return!1;return!0},this.updateSelectedNodes=function(){for(var e=0;e<this.selectedElements.length;e++){var t=this.selectedElements[e];t.onSelected()}return!0},this.addEventListener("onMousedown",function(e){var t=e.x,n=e.y,i=r.getelementByXY(t,n);i?(i.onMousedown({x:t,y:n,scene:r}),r.dispatchEvent("mousedown",{target:i,x:t,y:n,scene:r}),r.notInSelectedNodes(i)?r.cancleAllSelected():i!=r.currentelement&&r.updateSelectedNodes(t,n),r.pushSelected(i)):(r.cancleAllSelected(),r.dispatchEvent("mousedown",{x:t,y:n,scene:r})),r.currentelement=i}),this.addEventListener("onMousedrag",function(e){var t=e.x,n=e.y,i=e.dx,s=e.dy;if(r.currentelement&&r.currentelement.dragable){r.currentelement.onMousedrag({x:t,y:n,dx:i,dy:s,scene:r}),r.dispatchEvent("mousedrag",{target:r.currentelement,x:t,y:n,dx:i,dy:s,scene:r});for(var o=0;o<r.selectedElements.length;o++){var u=r.selectedElements[o];if(u===r.currentelement)continue;var a=u.selectedLocation.x+i,f=u.selectedLocation.y+s;u.setLocation(a,f)}}else{var l=t>=r.mouseDownX?r.mouseDownX:t,c=n>=r.mouseDownY?r.mouseDownY:n,h=Math.abs(t-r.mouseDownX),p=Math.abs(n-r.mouseDownY);r.clearOperations().addOperation(function(e){e.beginPath(),e.strokeStyle="rgba(0,0,236,0.5)",e.fillStyle="rgba(0,0,236,0.1)",e.rect(l,c,h,p),e.fill(),e.stroke(),e.closePath()});for(var o=0;o<r.elements.length;o++){var u=r.elements[o];u.x>l&&u.x+u.width<l+h?u.y>c&&u.y+u.height<c+p&&r.pushSelected(u):u.cancleSelected()}}}),this.addEventListener("onMousemove",function(e){var t=e.x,n=e.y,i=r.getelementByXY(t,n);i?(r.mouseOverelement&&r.mouseOverelement!==i&&r.mouseOverelement.onMouseout(e),r.mouseOverelement=i,i.isOnMousOver||(i.onMouseover(e),r.dispatchEvent("mouseover",{target:i,x:t,y:n,scene:r}))):r.mouseOverelement&&(r.mouseOverelement.onMouseout(e),r.dispatchEvent("mouseout",{target:r.mouseOverelement,x:t,y:n,scene:r}),r.mouseOverelement=null)}),this.addEventListener("onMouseup",function(e){var t=e.x,n=e.y,i=r.currentelement;r.clearOperations(),r.currentelement?(r.mouseOverelement&&r.mouseOverelement!=r.currentelement&&r.currentelement.onMouseup(e),r.dispatchEvent("mouseup",{target:r.currentelement,x:t,y:n,scene:r})):r.dispatchEvent("mouseup",e),i&&i.layout&&i.layout.auto==1&&r.layoutNode(i)}),this.isAllEndpoint=function(e){for(var t=0;t<e.length;t++){var n=this.getChilds(e[t]);if(n.length>0)return!1}return!0},this.getChilds=function(e){var t=[];for(var n=0;n<this.links.length;n++)this.links[n].nodeA===e&&t.push(this.links[n].nodeZ);return t},this.layoutNode=function(t){var n=this.getChilds(t);if(n.length==0)return null;e.Layout.adjustPosition(t,n);if(this.isAllEndpoint(n))return null;for(var r=0;r<n.length;r++)this.layoutNode(n[r]);return null},r}e.AbstractScene=t,n.prototype=new e.AbstractScene,e.Scene=n}(JTopo),function(e){function t(){this.initialize=function(){},this.getLocation=function(e,t){return{x:this.x,y:this.y}},this.setLocation=function(e,t){return this.x=e,this.y=t,this},this.setCenterLocation=function(e,t){return this.x=e-this.width/2,this.y=t-this.height/2,this},this.getCenterLocation=this.getCenterXY=function(){return{x:this.x+this.width/2,y:this.y+this.height/2}},this.getSize=function(){return{width:this.width,height:this.heith}},this.setSize=function(e,t){return this.width=e,this.height=t,this},this.setBound=function(e,t,n,r){return this.setLocation(e,t),this.setSize(n,r),this},this.getBound=function(){return{left:this.x,top:this.y,right:this.x+this.width,bottom:this.y+this.height}},this.onSelected=function(){this.selected=!0,this.selectedLocation={x:this.x,y:this.y}},this.cancleSelected=function(){this.selected=!1,this.selectedLocation=null},this.onMousedown=function(e){this.mousedownX=e.x,this.mousedownY=e.y,this.onSelected(),e.target=this,this.dispatchEvent("mousedown",e)},this.onMouseup=function(e){this.mouseupX=e.x,this.mouseupY=e.y,this.isOnMousedrag=!1,e.target=this,this.dispatchEvent("mouseup",e)},this.onMouseover=function(e){this.isOnMousOver=!0,this.dispatchEvent("mouseover",e)},this.onMouseout=function(e){this.isOnMousOver=!1,e.target=this,this.dispatchEvent("mouseout",e)},this.onMousedrag=function(e){this.isOnMousedrag=!0;var t=e.dx,n=e.dy,r=this.selectedLocation.x+t,i=this.selectedLocation.y+n;this.setLocation(r,i),e.target=this,this.dispatchEvent("mousedrag",e)},this.paint=function(e){e.beginPath(),e.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",e.rect(-this.width/2,-this.height/2,this.width,this.height),e.fill(),e.closePath()},this.addEventListener=function(t,n){return this.messageBus||(this.messageBus=new e.util.MessageBus),this.messageBus.subscribe(t,n),this},this.dispatchEvent=function(e,t){return this.messageBus?(this.messageBus.publish(e,t),this):null}}function n(){this.initialize=function(){n.prototype.initialize.apply(this,arguments),this.x=0,this.y=0,this.width=32,this.height=32,this.visible=!0,this.translate=!0,this.alpha=1,this.rotate=0,this.scalaX=1,this.scalaY=1,this.style={fillStyle:"22,119,238"}},this.initialize(arguments)}function r(e,t){this.initialize();var n=r.imageChace;n==null&&(n=r.imageChace={}),this.setImage=function(e,t){var r=this;if(typeof e=="string"){var i=n[e];i==null?(i=new Image,i.src=e,t&&(i.onload=function(){n[e]=i,r.setSize(i.width,i.height)})):t&&this.setSize(i.width,i.height),this.image=i}else this.image=e,t&&e&&e.width&&e.height&&this.setSize(e.width,e.height)},e&&this.setImage(e,t),this.paint=function(e){if(!this.image)return;e.save(),e.beginPath(),e.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",e.drawImage(this.image,-this.width/2,-this.height/2),e.fill(),e.closePath(),e.restore()}}function i(e){this.initialize(),this.paint=e}n.prototype=new t,r.prototype=new n,i.prototype=new n,e.AbstractElement=t,e.Element=n,e.ImageElement=r,e.CustomElement=i}(JTopo),function(e){function t(e){this.initialize=function(e){t.prototype.initialize.apply(this,arguments),this.style.fontColor="255,255,255",this.style.fontSize="10pt",this.style.font="Consolas",this.name=e,this.dragable=!0,this.selectable=!0,this.selected=!1,this.label={position:"Bottom_Center"}},this.initialize(e),this.paint=function(e){(this.selected||this.isOnMousOver)&&this.drawSelectedRect(e),this.image?this.alarm?t.prototype.paint.call(this,e):t.prototype.paint.call(this,e):this.alarm?(e.beginPath(),e.fillStyle="rgba(255,0,0,"+this.alpha+")",e.rect(-this.width/2,-this.height/2,this.width,this.height),e.fill(),e.closePath()):(e.beginPath(),e.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",e.rect(-this.width/2,-this.height/2,this.width,this.height),e.fill(),e.closePath()),this.drawText(e)},this.paintAlarmText=function(e){var t=this.width/2,n=-this.height/2-20;e.save(),e.beginPath(),e.strokeStyle="rgba(255,255,0,0.7)",e.fillStyle="rgba(255, 0, 0, 0.2)",e.fillRect(t,n,30,20),e.strokeText(this.alarm,t+3,n+20),e.stroke(),e.closePath(),e.restore()},this.paintAlarm=function(e){function r(e,t,r){for(var i=0;i<e;i++)for(var s=0;s<t;s++){var o=(i+s*e)*4,u=r[o+0],a=r[o+1],f=r[o+2],l=r[o+3],c=n[o+0],h=n[o+1],p=n[o+2],d=.299*u+.587*a+.114*f;if(u!=c||a!=h||f!=p)r[o+0]=255,r[o+1]=d,r[o+2]=d,r[o+3]=255}}this.paintAlarmText(e);var t=e.getImageData(this.x,this.y,this.image.width,this.image.height),n=t.data;e.drawImage(this.image,-this.width/2,-this.height/2);var i=e.getImageData(this.x,this.y,this.image.width,this.image.height);r(this.image.width,this.image.height,i.data),e.putImageData(i,this.x,this.y,0,0,this.image.width,this.image.height),e.closePath()},this.drawSelectedRect=function(e){if(!this.selectable)return;var t=this.name,n=t?e.measureText(t).width:0,r=t?16:6,i=Math.max(this.width,n);e.save(),e.beginPath(),e.strokeStyle="rgba(168,202,255, 0.9)",e.fillStyle="rgba(168,202,236,0.7)",e.rect(-i/2-3,-this.height/2-3,i+6,this.height+r),e.fill(),e.stroke(),e.closePath(),e.restore()},this.drawText=function(e){var t=this.name;if(!t||t=="")return;var n=e.measureText(t).width;e.beginPath(),e.font=this.style.fontSize+" "+this.style.font,e.strokeStyle="rgba("+this.style.fontColor+", "+this.alpha+")";var r=this.getTextPostion(this.label.position,n);e.strokeText(t,r.x,r.y),e.closePath()},this.getTextPostion=function(e,t){var n={Top_Center:function(){return{x:-this.width/2+(this.width-t)/2,y:-this.height/2}},Top_Right:function(){return{x:this.width/2,y:-this.height/2}},Top_Left:function(){return{x:-this.width/2-t,y:-this.height/2}},Bottom_Center:function(){return{x:-this.width/2+(this.width-t)/2,y:this.height/2+12}},Bottom_Right:function(){return{x:this.width/2,y:this.height/2+12}},Bottom_Left:function(){return{x:-this.width/2-t,y:this.height/2+12}},Middle_Center:function(){return{x:-this.width/2+(this.width-t)/2,y:0}},Middle_Right:function(){return{x:this.width/2,y:0}},Middle_Left:function(){return{x:-this.width/2-t,y:0}}},r=n[e];r==null&&(r=n.Bottom_Center);var i=r.call(this);return this.label.offsetX&&typeof this.label.offsetX=="number"&&(i.x+=this.label.offsetX),this.label.offsetY&&typeof this.label.offsetY=="number"&&(i.y+=this.label.offsetY),i}}function n(e){this.initialize(),this.height=14,this.name=e,this.paint=function(e){var t=e.measureText(this.name).width;this.width=t,e.beginPath(),e.font=this.style.fontSize+" "+this.style.font,e.strokeStyle="rgba("+this.style.fontColor+", "+this.alpha+")",e.strokeText(this.name,-this.width/2,-this.height/2+12),e.closePath()}}function r(e){this.initialize(),this.setSize(100,100),this.name=e,this.translate=!1,this.paint=function(e){if(!this.visible)return;var t=this.x,n=this.y;e.beginPath(),e.strokeStyle="rgba(230, 230, 230, 0.8)",e.moveTo(t+50,n),e.quadraticCurveTo(t,n,t,n+37.5),e.quadraticCurveTo(t,n+75,t+25,n+75),e.quadraticCurveTo(t+25,n+95,t+5,n+100),e.quadraticCurveTo(t+35,n+95,t+45,n+75),e.quadraticCurveTo(t+100,n+75,t+100,n+37.5),e.quadraticCurveTo(t+100,n,t+50,n),e.strokeText(this.name,this.x+20,this.y+20),e.stroke(),e.closePath()}}function i(){this.initialize(),this.setSize(120,120),this.translate=!1,this.paint=function(e){if(!this.visible)return;e.save(),e.beginPath(),e.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",e.moveTo(this.x+75,this.y+40),e.bezierCurveTo(this.x+75,this.y+37,this.x+70,this.y+25,this.x+50,this.y+25),e.bezierCurveTo(this.x+20,this.y+25,this.x+20,this.y+62.5,this.x+20,this.y+62.5),e.bezierCurveTo(this.x+20,this.y+80,this.x+40,this.y+102,this.x+75,this.y+120),e.bezierCurveTo(this.x+110,this.y+102,this.x+130,this.y+80,this.x+130,this.y+62.5),e.bezierCurveTo(this.x+130,this.y+62.5,this.x+130,this.y+25,this.x+100,this.y+25),e.bezierCurveTo(this.x+85,this.y+25,this.x+75,this.y+37,this.x+75,this.y+40),e.fill(),e.closePath(),e.restore()}}function s(e){this.initialize(),this.style.fillStyle="71, 167, 184",this.className=e,this.rowHeight=18,this.width=268,this.classObj=null,this.translate=!1,this.operations=null,this.attributes=null,this.maxItem=10,this.paint=function(e){if(!this.visible)return;if(this.classObj!=null){this.operations=[],this.attributes=[];for(var t in this.classObj){if(i>this.maxItem)break;var n=this.classObj[t];if(typeof n=="function"){var r="(";for(var i=0;i<n.length;i++)r+="arg"+i,i+1<n.length&&(r+=", ");r+=")",t.length+r.length>35?(this.operations.push("+ "+t+r.substring(0,35-t.length)),this.operations.push("  "+r.substring(35-t.length))):this.operations.push("+ "+t+r)}else this.attributes.push("- "+t+": "+typeof n)}}if(this.operations==null||this.operations.length==0)this.operations=[" "];if(this.attributes==null||this.attributes.length==0)this.attributes=[" "];this.operations.length>this.maxItem&&(this.operations=this.operations.splice(0,this.maxItem),this.operations.push("  ...")),this.attributes.length>this.maxItem&&(this.attributes=this.attributes.splice(0,this.maxItem),this.attributes.push("  ...")),this.height=(this.operations.length+this.attributes.length+1)*this.rowHeight+3,e.save(),e.beginPath(),e.fillStyle="rgba(239,247,149,"+this.alpha+")",e.rect(this.x,this.y,this.width,this.height),e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0,e.fill(),e.font=this.style.fontSize+" "+this.style.font,e.moveTo(this.x,this.y+this.rowHeight+3),e.lineTo(this.x+this.width,this.y+this.rowHeight+3);var s=e.measureText(this.className).width;e.strokeText(this.className,this.x+(this.width-s)/2,this.y+this.rowHeight);for(var i=0;i<this.operations.length;i++){var o=this.operations[i];e.strokeText(o,this.x+5,this.y+this.rowHeight+this.rowHeight*(i+1))}e.moveTo(this.x,this.y+this.rowHeight*(this.operations.length+1)+3),e.lineTo(this.x+this.width,this.y+this.rowHeight*(this.operations.length+1)+3);var u=this.y+this.rowHeight*(this.operations.length+1);for(var i=0;i<this.attributes.length;i++){var a=this.attributes[i];e.strokeText(a,this.x+5,u+this.rowHeight*(i+1))}e.stroke(),e.closePath(),e.restore()}}function o(e){this.initialize(),this.radius=30,this.beginDegree=0,this.endDegree=2*Math.PI,this.name=e,this.paint=function(e){(this.selected||this.isOnMousOver)&&this.drawSelectedRect(e);if(this.visible==0)return;var t=this.radius*2,n=this.radius*2;this.width=t,this.height=n,e.save(),e.beginPath(),e.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",e.arc(0,0,this.radius,this.beginDegree,this.endDegree,!0),e.fill(),e.closePath(),e.restore(),this.drawText(e)}}function u(e,t,n){this.initialize(),this.frameImages=e||[],this.frameIndex=0,this.isStop=!0;var r=t||1e3;this.repeatPlay=!1;var i=this;this.nextFrame=function(){if(this.isStop)return;if(this.frameImages.length==null)return;this.frameIndex++;if(this.frameIndex>=this.frameImages.length){if(!this.repeatPlay)return;this.frameIndex=0}this.setImage(this.frameImages[this.frameIndex],n),setTimeout(function(){i.nextFrame()},r/e.length)}}function a(e,t,n,r,i){this.initialize();var s=this;this.setImage(e),this.frameIndex=0,this.isPause=!0,this.repeatPlay=!1;var o=r||1e3;i=i||0,this.paint=function(e){if(!this.image)return;var t=this.width,r=this.height;e.save(),e.beginPath(),e.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")";var s=(Math.floor(this.frameIndex/n)+i)*r,o=Math.floor(this.frameIndex%n)*t;e.drawImage(this.image,o,s,t,r,-t/2,-r/2,t,r),e.fill(),e.closePath(),e.restore()},this.nextFrame=function(){if(this.isStop)return;this.frameIndex++;if(this.frameIndex>=t*n){if(!this.repeatPlay)return;this.frameIndex=0}setTimeout(function(){if(s.isStop)return;s.nextFrame()},o/(t*n))}}function f(){var e=null;return arguments.length<=3?e=new u(arguments[0],arguments[1],arguments[2]):e=new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),e.stop=function(){e.isStop=!0},e.play=function(){e.isStop=!1,e.frameIndex=0,e.nextFrame()},e}t.prototype=new e.ImageElement,n.prototype=new t,r.prototype=new t,i.prototype=new t,s.prototype=new t,o.prototype=new t,u.prototype=new t,a.prototype=new t,f.prototype=new t,e.Node=t,e.TextNode=n,e.UMLClassNode=s,e.TipNode=r,e.HeartNode=i,e.CircleNode=o,e.AnimateNode=f}(JTopo),function(e){function t(e,t,n){this.initialize=function(e,t,n){if(arguments.length==0)return;this.name=n,this.nodeA=e,this.nodeZ=t,this.alpha=1,this.style={strokeStyle:"116, 166, 250",lineWidth:2,fontSize:"12pt",fontColor:"255,255,0",lineJoin:"miter"}},this.initialize(e,t,n),this.paint=function(n){if(!this.nodeA||!this.nodeZ)return;n.beginPath(),n.strokeStyle="rgba("+this.style.strokeStyle+","+this.alpha+")",n.lineWidth=this.style.lineWidth,e===t?n.arc(this.nodeA.x,this.nodeA.y,e.width/2,0,2*Math.PI):(n.moveTo(this.nodeA.x+this.nodeA.width/2,this.nodeA.y+this.nodeA.height/2),n.lineTo(this.nodeZ.x+this.nodeZ.width/2,this.nodeZ.y+this.nodeZ.height/2)),n.stroke(),n.closePath(),this.paintText(n)},this.paintText=function(e){if(this.name){var t=this.name;if(!t||t=="")return;var n=e.measureText(t).width;e.beginPath(),e.lineWidth=1,e.font=this.style.fontSize+" "+this.style.font,e.strokeStyle="rgba("+this.style.fontColor+", "+this.alpha+")",e.strokeText(t,this.nodeA.x+(this.nodeZ.x-this.nodeA.x)/2,this.nodeA.y+(this.nodeZ.y-this.nodeA.y)/2+12),e.stroke(),e.closePath()}}}function n(e,t,r,i){this.initialize=function(){n.prototype.initialize.apply(this,arguments),this.fold=i||"x"},this.initialize(e,t,r,i),this.paint=function(e){if(!this.nodeA||!this.nodeZ)return;var t=this.nodeA.getCenterXY(),n=this.nodeZ.getCenterXY();e.save(),e.beginPath(),e.lineJoin=this.style.lineJoin,e.strokeStyle="rgba("+this.style.strokeStyle+","+this.alpha+")",e.lineWidth=this.style.lineWidth,e.moveTo(t.x,t.y),this.fold=="y"?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y),e.lineTo(n.x,n.y),e.stroke(),e.closePath(),e.restore()}}function r(e,t,n){this.initialize=function(){r.prototype.initialize.apply(this,arguments),this.offset=20},this.initialize(e,t,n),this.paint=function(e){if(!this.nodeA||!this.nodeZ)return;e.beginPath(),e.strokeStyle="rgba("+this.style.strokeStyle+","+this.alpha+")",e.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",e.lineWidth=this.style.lineWidth,e.lineJoin=this.style.lineJoin;var t={x:this.nodeA.x+this.nodeA.width/2,y:this.nodeA.y+this.nodeA.height/2},n={x:this.nodeZ.x+this.nodeZ.width/2,y:this.nodeZ.y+this.nodeZ.height/2},r=Math.atan2(t.y-n.y,t.x-n.x);n.x=n.x+Math.cos(r)*this.nodeZ.width/2,n.y=n.y+Math.sin(r)*this.nodeZ.height/2;var i=.4,s={x:n.x+Math.cos(r-i)*this.offset,y:n.y+Math.sin(r-i)*this.offset},o={x:n.x+Math.cos(r+i)*this.offset,y:n.y+Math.sin(r+i)*this.offset};e.moveTo(this.nodeA.x+this.nodeA.width/2,this.nodeA.y+this.nodeA.height/2),e.lineTo(s.x+(o.x-s.x)/2,s.y+(o.y-s.y)/2),e.moveTo(s.x,s.y),e.lineTo(n.x,n.y),e.lineTo(o.x,o.y),e.lineTo(s.x,s.y),this.style.fillStyle!=null&&e.fill(),e.stroke(),e.closePath()}}function i(e,t,n,r){this.initialize=function(){i.prototype.initialize.apply(this,arguments),this.offset=20,this.fold=r||"x",this.offset=20},this.initialize(e,t,n,r),this.paint=function(e){if(!this.nodeA||!this.nodeZ)return;var t=this.nodeA.x,n=this.nodeA.y,r=this.nodeZ.x,i=this.nodeZ.y,s=t,o=n;if(t==r||n==i){e.save(),e.beginPath(),e.strokeStyle="rgba("+this.style.strokeStyle+","+this.alpha+")",e.lineWidth=this.style.lineWidth,e.lineJoin=this.style.lineJoin;var u={x:this.nodeA.x+this.nodeA.width/2,y:this.nodeA.y+this.nodeA.height/2},a={x:this.nodeZ.x+this.nodeZ.width/2,y:this.nodeZ.y+this.nodeZ.height/2},f=Math.atan2(u.y-a.y,u.x-a.x);a.x=a.x+Math.cos(f)*this.nodeZ.width/2,a.y=a.y+Math.sin(f)*this.nodeZ.height/2;var l=.4,c={x:a.x+Math.cos(f-l)*this.offset,y:a.y+Math.sin(f-l)*this.offset},h={x:a.x+Math.cos(f+l)*this.offset,y:a.y+Math.sin(f+l)*this.offset};e.lineTo(c.x+(h.x-c.x)/2,c.y+(h.y-c.y)/2),e.moveTo(c.x,c.y),e.lineTo(a.x,a.y),e.lineTo(h.x,h.y),e.lineTo(c.x,c.y),this.style.fillStyle!=null&&e.fill(),e.closePath(),e.stroke(),e.restore()}else{this.fold=="x"?s=t+(r-t):o=n+(i-n),e.save(),e.beginPath(),e.strokeStyle="rgba("+this.style.strokeStyle+","+this.alpha+")",e.lineWidth=this.style.lineWidth,e.lineJoin=this.style.lineJoin,e.moveTo(t+this.nodeA.width/2,n+this.nodeA.height/2),e.lineTo(s+this.nodeA.width/2,o+this.nodeA.height/2);var u={x:s+this.nodeA.width/2,y:o+this.nodeA.height/2},a={x:this.nodeZ.x+this.nodeZ.width/2,y:this.nodeZ.y+this.nodeZ.height/2},f=Math.atan2(u.y-a.y,u.x-a.x);a.x=a.x+Math.cos(f)*this.nodeZ.width/2,a.y=a.y+Math.sin(f)*this.nodeZ.height/2;var l=.4,c={x:a.x+Math.cos(f-l)*this.offset,y:a.y+Math.sin(f-l)*this.offset},h={x:a.x+Math.cos(f+l)*this.offset,y:a.y+Math.sin(f+l)*this.offset};e.lineTo(c.x+(h.x-c.x)/2,c.y+(h.y-c.y)/2),e.moveTo(c.x,c.y),e.lineTo(a.x,a.y),e.lineTo(h.x,h.y),e.lineTo(c.x,c.y),this.style.fillStyle!=null&&e.fill(),e.stroke(),e.closePath(),e.restore()}}}function s(e,t,n){this.initialize=function(){i.prototype.initialize.apply(this,arguments),this.flexional={direction:"vertical",extend:function(){return 20}}},this.initialize(e,t,n);var r=this.paintText;this.paint=function(e){if(!this.nodeA||!this.nodeZ)return;var t=this.nodeA.x,n=this.nodeA.y,i=this.nodeZ.x,s=this.nodeZ.y;e.beginPath(),e.lineJoin=this.style.lineJoin,e.strokeStyle="rgba("+this.style.strokeStyle+","+this.alpha+")",e.lineWidth=this.style.lineWidth;if(t==i||n==s)e.moveTo(this.nodeA.x+this.nodeA.width/2,this.nodeA.y+this.nodeA.height/2),e.lineTo(this.nodeZ.x+this.nodeZ.width/2,this.nodeZ.y+this.nodeZ.height/2);else{var o=this.flexional.direction=="horizontal"?this.flexional.extend():0,u=this.flexional.direction=="vertical"?this.flexional.extend():0;o*=i-t>0?1:-1,u*=s-n>0?1:-1,e.moveTo(t+this.nodeA.width/2,n+this.nodeA.height/2),e.lineTo(t+this.nodeA.width/2+o,n+this.nodeA.height/2+u),e.lineTo(i+this.nodeA.width/2-o,s+this.nodeA.height/2-u),e.lineTo(i+this.nodeA.width/2,s+this.nodeA.height/2)}e.stroke(),e.closePath(),r.call(this,e)}}function o(e,t,n){this.initialize=function(){i.prototype.initialize.apply(this,arguments)},this.initialize(e,t,n),this.flexional.extend=function(){return this.flexional.direction=="horizontal"?Math.abs(t.x-e.x)/2:Math.abs(t.y-e.y)/2}}t.prototype=new e.AbstractElement,n.prototype=new t,r.prototype=new t,i.prototype=new t,s.prototype=new t,o.prototype=new s,e.Link=t,e.FoldLink=n,e.ArrowsLink=r,e.ArrowsFoldLink=i,e.FlexionalLink=s,e.OrthogonalLink=o}(JTopo),function(e){function t(n){this.initialize=function(e){t.prototype.initialize.apply(this,null),this.name=e,this.x=0,this.y=0,this.width=100,this.height=100,this.items=[],this.style={fillStyle:"255, 255, 255"},this.alpha=.6,this.dragable=!0,this.childDragble=null,this.visible=!0},this.initialize(n),this.add=function(e){this.items.push(e),e.parentContainer=this,this.updateBound(),this.childDragble&&(e.dragable=this.childDragble)},this.remove=function(e){for(var t=0;t<this.items.length;t++)if(this.items[t]===e){e.parentContainer=null,this.items=this.items.del(t),e.lastParentContainer=this;break}},this.clear=this.removeAll=function(){for(var e=0;e<this.items.length;e++)this.remove(this.items[e])},this.setLocation=function(e,t){var n=e-this.x,r=t-this.y;this.x=e,this.y=t;for(var i=0;i<this.items.length;i++){var s=this.items[i];s.setLocation(s.x+n,s.y+r)}},this.updateBound=function(){for(var e=0
;e<this.items.length;e++){var t=this.items[e];t.x<this.x&&(t.x=this.x),t.y<this.y&&(t.y=this.y),t.x+t.width>this.x+this.width&&(t.x=this.x+this.width-t.width),t.y+t.height>this.y+this.height&&(t.y=this.y+this.height-t.height)}},this.paint=function(t){this.layout&&e.Layout.adjustPosition(this,this.items),this.updateBound();if(!this.visible)return;t.beginPath(),t.shadowBlur=9,t.shadowColor="rgba(0,0,0,0.5)",t.shadowOffsetX=3,t.shadowOffsetY=3,t.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",t.fillRect(this.x,this.y,this.width,this.height),t.closePath()}}function n(){this.initialize(arguments),this.updateBound=function(){var e={x:1e7,y:1e6,width:0,height:0};if(this.items.length>0){var t=1e7,n=-1e7,r=1e7,i=-1e7,s=n-t,o=i-r;for(var u=0;u<this.items.length;u++){var a=this.items[u];a.x<=t&&(t=a.x),a.x>=n&&(n=a.x),a.y<=r&&(r=a.y),a.y>=i&&(i=a.y),s=n-t+a.width,o=i-r+a.height}this.x=t,this.y=r,this.width=s,this.height=o}}}function r(){this.initialize(arguments),this.paint=function(e){if(this.items.length<2)return;var t=[];for(var n=0;n<this.items.length;n++){var r=this.items[n].getCenterXY();t.push(r)}for(var n=0;n<t.length-2;n+=3)e.beginPath(),e.moveTo(t[n].x,t[n].y),this.items[n+1].style.fillStyle="0,255,0",e.quadraticCurveTo(t[n+1].x,t[n+1].y,t[n+2].x,t[n+2].y),e.stroke(),e.closePath(),e.save(),e.beginPath(),e.lineWidth=1,e.strokeStyle="rgba(0,255,0,0.3)",e.moveTo(t[n].x,t[n].y),e.lineTo(t[n+1].x,t[n+1].y),e.stroke(),e.closePath(),e.restore()}}t.prototype=new e.AbstractElement,n.prototype=new t,r.prototype=new t,e.Container=t,e.AutoSizeContainer=n,e.EditContainer=r}(JTopo),function(e){function t(e,t,n,r,i,s){var o=i?i:0,u=s?s:2*Math.PI,a=u-o,f=a/n,l=[];o+=f/2;for(var c=o;c<=u;c+=f){var h=e+Math.cos(c)*r,p=t+Math.sin(c)*r;l.push({x:h,y:p})}return l}function n(e,t,n,r,i,s){var o=s||"bottom",u=[];if(o=="bottom"){var a=e-n/2*r+r/2;for(var f=0;f<=n;f++)u.push({x:a+f*r,y:t+i})}else if(o=="top"){var a=e-n/2*r+r/2;for(var f=0;f<=n;f++)u.push({x:a+f*r,y:t-i})}else if(o=="right"){var a=t-n/2*r+r/2;for(var f=0;f<=n;f++)u.push({x:e+i,y:a+f*r})}else if(o=="left"){var a=t-n/2*r+r/2;for(var f=0;f<=n;f++)u.push({x:e-i,y:a+f*r})}return u}function r(e,t,n,r,i,s){var o=s||"horizontal",u=[],a=Math.round(n/2),f=e+r;if(o=="horizontal"){for(var l=0;l<a;l++)u.push({x:f+l*r,y:t-i});for(var l=a;l<=n;l++)u.push({x:f+l*r,y:t+i})}else o=="vertical";return u}function i(e,t,n,r,i,s){var o=[];for(var u=0;u<n;u++)for(var a=0;a<r;a++)o.push({x:e+a*i,y:t+u*s});return o}function s(e,r){if(!e.layout)return;var s=e.layout,o=s.type,u=null,a=e.getCenterXY();if(o=="star")u=t(a.x,a.y,r.length,e.layout.radius,e.layout.beginDegree,e.layout.endDegree);else if(o=="tree")u=n(a.x,a.y,r.length,s.width,s.height,s.direction);else{if(o!="grid")return;u=i(a.x,a.y,s.rows,s.cols,s.horizontal||0,s.vertical||0)}for(var f=0;f<r.length;f++)r[f].setCenterLocation(u[f].x,u[f].y)}e.Layout={adjustPosition:s}}(JTopo),function(e){function t(){var t=new e.CircleNode;return t.radius=150,t.colors=["#3666B0","#2CA8E0","#77D1F6"],t.datas=[.3,.3,.4],t.translate=!1,t.paint=function(e){var n=t.radius*2,r=t.radius*2;t.width=n,t.height=n;var i=0;for(var s=0;s<this.datas.length;s++){var o=this.datas[s]*Math.PI*2;e.beginPath(),e.fillStyle=t.colors[s],e.moveTo(this.x+n/2,this.y+r/2),e.arc(this.x+n/2,this.y+r/2,this.radius/2,i,i+o,!1),e.fill(),e.closePath(),i+=o}},t}e.PieChartNode=t}(JTopo),function(e){function t(e,t){var n=null,r;return{stop:function(){return r?(window.clearInterval(r),n&&n.publish("stop"),this):this},start:function(){var n=this;return r=setInterval(function(){e.call(n)},t),this},onStop:function(e){return n==null&&(n=new Jcool.util.MessageBus),n.subscribe("stop",e),this}}}function n(e,n){n=n||{};var r=n.gravity||.1,i=n.dx||0,s=n.dy||5,o=n.stop,u=n.interval||30,a=new t(function(){o&&o()?(s=.5,this.stop()):(s+=r,e.setLocation(e.x+i,e.y+s))},u);return a}function r(e,n,r,i,s){var o=50,u={};for(var a in n){var f=n[a],l=f-e[a];u[a]={oldValue:e[a],targetValue:f,step:l/r*o,isDone:function(t){var n=this.step>0&&e[t]>=this.targetValue||this.step<0&&e[t]<=this.targetValue;return n}}}var c=new t(function(){var t=!0;for(var r in n)u[r].isDone(r)||(e[r]+=u[r].step,t=!1);if(t){if(!i)return this.stop();for(var r in n)if(s){var o=u[r].targetValue;u[r].targetValue=u[r].oldValue,u[r].oldValue=o,u[r].step=-u[r].step}else e[r]=u[r].oldValue}},o);return c}function i(t,n){function s(n,i,s,o,u){var a=new e.Node;return a.setImage(t.image),a.setSize(t.width,t.height),a.style=r,a.setLocation(n,i),a.paint=function(e){e.save(),e.arc(0,0,s,o,u),e.clip(),e.beginPath(),this.image!=null?e.drawImage(this.image,-this.width/2,-this.height/2):(e.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")",e.rect(this.x,this.y,this.width,this.height),e.fill()),e.closePath(),e.restore()},a}var r=t.style,i=n.angle,o=i,u=i+Math.PI,a=s(t.x,t.y,t.width,o,u),f=s(t.x,t.y,t.width,o+Math.PI,o);return[a,f]}e.Animate={},e.Effect={},e.Animate.gravity=n,e.Animate.stepByStep=r,e.Effect.splitTwoPiece=i}(JTopo)
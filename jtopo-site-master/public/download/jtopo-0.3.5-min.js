(function(a){JTopo={version:"0.3.5"};a.JTopo=JTopo})(window);(function(l){function b(n){var m=this;this.name=n;this.messageMap={};this.messageCount=0;this.subscribe=function(p,q){if(!typeof p=="string"){o(p,q)}else{var r=m.messageMap[p];if(r==null){m.messageMap[p]=[]}m.messageMap[p].push(q);m.messageCount++}};function o(w,u){var s=[];var p=0;for(var r=0;r<w.length;r++){var q=w[r];var v=m.messageMap[q];if(v==null){m.messageMap[q]=[]}function t(x){s[r]=x;p++;if(p==w.length){p=0;return u.apply(null,s)}else{return null}}m.messageMap[q].push(t);m.messageCount++}}this.unsubscribe=function(p){var q=m.messageMap[p];if(q!=null){m.messageMap[p]=null;delete (m.messageMap[p]);m.messageCount--}};this.publish=function(p,s,r){var t=m.messageMap[p];if(t!=null){for(var q=0;q<t.length;q++){if(r){(function(v,u){setTimeout(function(){v(u)},10)})(t[q],s)}else{t[q](s)}}}}}function f(p,o){var n=o.x-p.x;var m=o.y-p.y;return Math.sqrt(n*n+m*m)}Array.prototype.del=function(o){if(typeof o!="number"){for(var m=0;m<this.length;m++){if(this[m]===o){return this.slice(0,m).concat(this.slice(m+1,this.length))}}return this}else{if(o<0){return this}return this.slice(0,o).concat(this.slice(o+1,this.length))}};if(![].indexOf){Array.prototype.indexOf=function(n){for(var m=0;m<this.length;m++){if(this[m]===n){return m}}return -1}}if(!window.console){window.console={log:function(m){},info:function(m){},debug:function(m){},warn:function(m){},error:function(m){}}}function j(m){if(m.pageX||m.pageY){return{x:m.pageX,y:m.pageY}}return{x:m.clientX+document.body.scrollLeft-document.body.clientLeft,y:m.clientY+document.body.scrollTop-document.body.clientTop}}function c(n){n=n||j(window.event);var m=document.body.scrollLeft+(n.x||n.layerX);var o=document.body.scrollTop+(n.y||n.layerY);return{x:m,y:o}}function k(p,o,t,q,n){var v=t-p;var u=q-o;var m=Math.sqrt(v*v+u*u);var s=Math.atan2(u,v)+n;return{x:p+Math.cos(s)*m,y:o+Math.sin(s)*m}}function d(r,o,s){var m=[];for(var n=0;n<o.length;n++){var q=k(r.x,r.y,o[n].x,o[n].y,s);m.push(q)}return m}function h(o,q,p){if(o.length==0){return}var r=0;function m(s){if(s==o.length){return}q(o[s]);setTimeout(function(){m(++s)},p)}m(r)}function a(q,p,s,r){if(p<q){return}var t=0;function o(m){if(m==p){return}s(p);setTimeout(function(){o(++m)},r)}o(t)}function g(o){var m={};for(var n in o){m[n]=o[n]}return m}function e(r,q){var n=q.x;var s=q.y;var o=q.width;var m=q.height;return(r.x>n&&r.x<n+o)&&(r.y>s&&r.y<s+m)}function i(s,n,t){var r=l.util.getDistance(n,t);var q=l.util.getDistance(n,s);var o=l.util.getDistance(t,s);var m=Math.abs(q+o-r)<=3;return m}l.util={rotatePoint:k,rotatePoints:d,getDistance:f,getXY:c,mouseCoords:j,MessageBus:b,isIE:(!+[1]),clone:g,isPointInRect:e,isPointInLine:i};window.$for=a;window.$foreach=h})(JTopo);(function(a){function b(g){var k=this;a.stage=k;this.initialize=function(){this.scenes=[];this.width=0;this.height=0;this.frames=16;this.messageBus=new a.util.MessageBus();this.currentScene=null;this.canvas=g;this.width=g.width;this.height=g.height;this.graphics=g.getContext("2d");this.offsetX=g.offsetLeft;this.offsetY=g.offsetTop;this.mode="select";this.translateX=0;this.translateY=0;this.mouseDownX=0;this.mouseDownY=0;this.isOnMouseDown=false;this.controlRect={width:10,height:10}};this.initialize();function e(o){var q=a.util.getXY(o);return{x:q.x-k.offsetX,y:q.y-k.offsetY}}function h(o){var q=e(o);if(a.util.isIE){return{x:q.x-k.translateX,y:q.y-k.translateY,scene:k.currentScene}}else{return{x:q.x-k.translateX,y:q.y-k.translateY,button:o.button,ctrlKey:o.ctrlKey,altKey:o.altKey,shiftKey:o.shiftKey,pageX:o.pageX,pageY:o.pageY,scene:k.currentScene}}}var j=true;document.oncontextmenu=function(o){return j};function c(o){j=true;document.onselectstart=function(){return true}}function n(o){j=false;document.onselectstart=function(){return false}}function f(p){var o=h(p);k.dispatchEvent("mousedown",o);k.isOnMouseDown=true;k.mouseDownX=o.x;k.mouseDownY=o.y;if(k.mode=="select"||k.mode=="edit"){if(k.currentScene){k.currentScene.mousedownHander(o)}}}function m(p){var o=h(p);k.dispatchEvent("mouseup",o);k.isOnMouseDown=false;if(k.mode=="select"||k.mode=="edit"){if(k.currentScene){k.currentScene.mouseupHander(o)}}}function i(q){if(k.isOnMouseDown&&k.mode=="drag"){var r=e(q);k.translateX=(r.x-k.mouseDownX);k.translateY=(r.y-k.mouseDownY)}if(k.mode=="drag"){g.style.cursor="pointer"}else{if(k.mode=="select"){g.style.cursor="default"}else{if(k.mode=="edit"){g.style.cursor="default"}}}var o=h(q);k.dispatchEvent("mousemove",o);if(k.mode=="select"||k.mode=="edit"){if(k.currentScene){k.currentScene.mousemoveHander(o)}}}function l(p){var o=h(p);k.dispatchEvent("click",o);if(k.mode=="select"||k.mode=="edit"){if(k.currentScene){k.currentScene.clickHander(o)}}}function d(p){var o=h(p);k.dispatchEvent("dbclick",o);if(k.mode=="select"||k.mode=="edit"){if(k.currentScene){k.currentScene.dbclickHander(o)}}}if(a.util.isIE){g.onmouseout=c;g.onmouseover=n;g.onmousedown=f;g.onmouseup=m;g.onmousemove=i;g.onclick=l;g.ondblclick=d}else{g.addEventListener("mouseout",c);g.addEventListener("mouseover",n);g.addEventListener("mousedown",f);g.addEventListener("mouseup",m);g.addEventListener("mousemove",i);g.addEventListener("click",l);g.addEventListener("dblclick",d)}if(a.util.isIE){}else{window.addEventListener("keydown",function(o){k.dispatchEvent("keydown",o);if(k.currentScene){k.currentScene.keydownHander(o)}},true);window.addEventListener("keyup",function(o){k.dispatchEvent("keyup",o);if(k.currentScene){k.currentScene.keyupHander(o)}},true)}this.play=function(o){if(this.currentScene){this.currentScene.hide()}this.currentScene=o;o.show();return this};this.add=function(o){o.initialize(this);this.play(o)};this.remove=function(p){for(var o=0;o<this.scenes.length;o++){if(this.scenes[o]===p){this.scenes=this.scenes.del(o);return this}}};this.clear=function(o){this.scenes=[];this.currentScene=null};this.addEventListener=function(o,p){this.messageBus.subscribe(o,p);return this};this.dispatchEvent=function(o,p){this.messageBus.publish(o,p);return this};this.saveImageInfo=function(){var p=this.canvas.toDataURL("image/png");var o=window.open("about:blank","image from canvas");o.document.write("<img src='"+p+"' alt='from canvas'/>");return this};this.saveAsLocalImage=function(){var o=this.canvas.toDataURL("image/png").replace("image/png","image/octet-stream");window.location.href=o;return this};this.repaint=function(){if(k.currentScene){this.graphics.save();this.graphics.translate(this.translateX,this.translateY);k.currentScene.repaint();this.graphics.restore()}return this};(function(){k.repaint();setTimeout(arguments.callee,1000/k.frames)})()}a.Stage=b})(JTopo);(function(b){function c(d){this.messageBus=new b.util.MessageBus();this.initialize=function(f){this.visible=false;this.rotate=0;this.alpha=1;this.scaleX=1;this.scaleY=1;this.elements=[];this.elementMap={};this.background=null;this.style={fillStyle:"238,238,238"};this.shadow=true;this.operations=[];this.stage=f;this.stage.scenes.push(this);this.width=f.width;this.height=f.height;this.graphics=f.graphics};this.show=function(){this.visible=true;this.paint()};this.hide=function(){this.visible=false};this.clear=function(){this.elements=[];this.elementMap=[];this.operations=[]};this.paintElements=function(m){var l=this.graphics;for(var h=0;h<m.length;h++){var f=m[h];if(f.visible!=true){continue}l.save();if(f.shadow==false){l.shadowBlur=0;l.shadowOffsetX=0;l.shadowOffsetY=0}if(f.translate){var k=f.scalaX||1;var j=f.scalaY||1;l.translate(f.x+f.width*k/2,f.y+f.height*j/2);if(f.rotate){l.rotate(f.rotate)}if(f.scalaX&&f.scalaY){l.scale(f.scalaX,f.scalaY)}else{if(f.scalaX){l.scale(f.scalaX,1)}else{if(f.scalaY){l.scale(1,f.scalaY)}}}}f.paint(l);l.restore();if(this.stage.mode=="edit"){if(f.editable==true&&f.selected==true){this.paintControlPoints(f)}}}};this.getElementControlRects=function(j){var f=this.stage.controlRect.width;var m=this.stage.controlRect.height;var l=j.width*j.scalaX;var o=j.height*j.scalaY;var i={};i.top_left={x:-l/2-f,y:-o/2-m};i.top_center={x:-(f/2),y:-o/2-m};i.top_right={x:l/2,y:-o/2-m};i.middle_left={x:-l/2-f,y:-(m/2)};i.middle_right={x:l/2,y:-(m/2)};i.bottom_left={x:-l/2-f,y:o/2};i.bottom_center={x:-(f/2),y:o/2};i.bottom_right={x:l/2,y:o/2};for(var g in i){var n=i[g];n.position=g;n.width=this.stage.controlRect.width;n.height=this.stage.controlRect.height}return i};this.paintControlPoints=function(l){var n=this.graphics;var r=this.stage.controlRect.width;var m=this.stage.controlRect.height;n.save();if(l.translate){var i=l.scalaX||1;var f=l.scalaY||1;n.translate(l.x+l.width*i/2,l.y+l.height*f/2)}n.strokeStyle="rgb(255,255,255)";n.shadowBlur=0;n.shadowOffsetX=0;n.shadowOffsetY=0;n.beginPath();var s=this.getElementControlRects(l);for(var j in s){var p=s[j];var q=p.x;var o=p.y;n.rect(q,o,r,m)}n.stroke();n.closePath();n.restore()};this.paintOperations=function(f){for(var g=0;g<f.length;g++){f[g](this.graphics)}};this.addOperation=function(f){this.operations.push(f);return this};this.clearOperations=function(){this.operations=[];return this};var e={};this.setBackground=function(f){if(typeof f=="string"){var g=e[f];if(g==null){g=new Image();g.src=f;e[f]=g}this.background=g}else{this.background=f}};this.paintBackgroud=function(f){this.graphics.save();if(this.background){this.graphics.drawImage(f,-this.stage.translateX,-this.stage.translateY,this.width,this.height)}else{this.graphics.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")";this.graphics.fillRect(-this.stage.translateX,-this.stage.translateY,this.width,this.height)}this.graphics.restore()};this.paint=function(){if(!this.visible||!this.stage){return}this.graphics.clearRect(0,0,this.width,this.height);var f=this.graphics;f.save();if(this.shadow){this.graphics.shadowBlur=5;this.graphics.shadowColor="rgba(0,0,0,0.5)";this.graphics.shadowOffsetX=3;this.graphics.shadowOffsetY=6}this.paintBackgroud(this.background);this.paintElements(this.elements);this.paintOperations(this.operations);f.restore()};this.repaint=function(){this.paint()};this.add=function(f){if(!f.id){f.id="id_"+(new Date).getTime()+this.elements.length}if(!this.elementMap[f.id]){this.elementMap[f.id]=f;this.elements.push(f)}};this.remove=function(f){this.removeFromArray("elements",f)};this.removeFromArray=function(j,g){var k=(typeof g)=="string"?g:g.id;if(g.id==null){return}if(this.elementMap[k]){delete this.elementMap[k]}for(var f=0;f<this[j].length;f++){var h=this[j][f];if(h.id===k){this[j]=this[j].del(f);return h}}return null};this.getelementByXY=function(f,k){var j=null;for(var h=this.elements.length-1;h>=0;h--){var g=this.elements[h];if(g.isInPath&&g.isInPath({x:f,y:k})==true){j=g}if(g.translate){if(f>g.x&&f<g.x+g.width*g.scalaX&&k>g.y&&k<g.y+g.height*g.scalaY){j=g;break}}else{if(f>g.x&&f<g.x+g.width&&k>g.y&&k<g.y+g.height){j=g;break}}}return j};this.toSceneEvent=function(f){return b.util.clone(f)};this.mousedownHander=function(f){var g=this.toSceneEvent(f);this.dispatchEvent("_mousedown",g)};this.clickHander=function(f){var g=this.toSceneEvent(f);this.dispatchEvent("_click",g)};this.dbclickHander=function(g){this.isOnDbclick=true;var f=g.x;var i=g.y;this.dbclickX=f;this.dbclickY=i;var h=this.toSceneEvent(g);this.dispatchEvent("_dbclick",h)};this.mousemoveHander=function(g){var h=this.toSceneEvent(g);var f=h.x;var i=h.y;if(this.stage.isOnMouseDown){h.dx=(f-this.stage.mouseDownX);h.dy=(i-this.stage.mouseDownY);this.dispatchEvent("_mousedrag",h)}else{this.dispatchEvent("_mousemove",h)}};this.mouseupHander=function(g){var f=g.x;var i=g.y;var h=this.toSceneEvent(g);this.dispatchEvent("_mouseup",h)};this.keydownHander=function(f){this.dispatchEvent("_keydown",f)};this.keyupHander=function(f){this.dispatchEvent("_keyup",f)};this.addEventListener=function(f,g){this.messageBus.subscribe(f,g);return this};this.dispatchEvent=function(f,g){this.messageBus.publish(f,g);return this}}b.AbstractScene=c;function a(d){var g=this;this.initialize=function(h){a.prototype.initialize.apply(this,arguments);this.nodes=[];this.links=[];this.containers=[];this.selectedElements=[]};if(d){this.initialize(d)}this.add=function(h){a.prototype.add.call(this,h);if(h instanceof b.Node){this.nodes.push(h)}else{if(h instanceof b.Link){this.links.push(h)}else{if(h instanceof b.Container){this.containers.push(h)}else{}}}};this.remove=function(h){a.prototype.remove.call(this,h);this.removeFromArray("nodes",h);this.removeFromArray("links",h);this.removeFromArray("containers",h)};this.clear=function(){a.prototype.clear.call(this);this.nodes=[];this.links=[];this.container=[]};var e=a.prototype.paintElements;this.paintElements=function(){e.call(this,this.containers);e.call(this,this.links);e.call(this,this.nodes)};this.pushSelected=function(h){h.onSelected();this.selectedElements.push(h)};this.cancleAllSelected=function(){for(var h=0;h<this.selectedElements.length;h++){this.selectedElements[h].cancleSelected()}this.selectedElements=[]};this.notInSelectedNodes=function(j){for(var h=0;h<this.selectedElements.length;h++){if(j===this.selectedElements[h]){return false}}return true};this.updateSelectedNodes=function(){for(var h=0;h<this.selectedElements.length;h++){var j=this.selectedElements[h];j.onSelected()}return true};this.addEventListener("_mousedown",function(l){var m=b.util.clone(l);var i=m.x;var n=m.y;var j=g.getelementByXY(i,n);if(j){j.onMousedown(m);m.target=j;if(g.notInSelectedNodes(j)){if(!l.ctrlKey){g.cancleAllSelected()}}else{if(j!=g.currentelement){g.updateSelectedNodes(i,n)}}g.pushSelected(j)}else{var h=null;if(g.stage.mode=="edit"){g.currentControlRect=g.getControlRectByXY(i,n)}if(g.currentControlRect!=null){var k=g.currentControlRect.element;k.selectedWidth=k.width;k.selectedHeight=k.height;k.resizeLocation={x:k.x,y:k.y}}else{if(!l.ctrlKey){g.cancleAllSelected()}}}g.dispatchEvent("mousedown",m);g.currentelement=j});this.addEventListener("_click",function(i){var j=b.util.clone(i);var h=g.getelementByXY(i.x,i.y);if(h){h.onClick(j)}g.dispatchEvent("click",j)});this.addEventListener("_dbclick",function(j){var k=b.util.clone(j);var h=k.x;var l=k.y;var i=g.getelementByXY(h,l);if(i){i.onDbclick(k);k.target=i;g.dispatchEvent("dbclick",k)}else{g.cancleAllSelected();g.dispatchEvent("dbclick",k)}g.currentelement=i});this.addEventListener("_mousedrag",function(j){var p=j.x;var o=j.y;var s=j.dx;var q=j.dy;if(g.currentelement&&g.currentelement.dragable){var l=b.util.clone(j);l.dx=s;l.dy=q;l.target=g.currentelement;for(var m=0;m<g.selectedElements.length;m++){var n=g.selectedElements[m];if(n===g.currentelement){continue}var h=n.selectedLocation.x+s;var r=n.selectedLocation.y+q;n.setLocation(h,r)}g.currentelement.onMousedrag(l);g.dispatchEvent("mousedrag",l)}else{if(g.stage.mode=="edit"){var k=g.currentControlRect;if(k!=null){if(k.element.resizeAble){g.elementResizeHandle(k,s,q)}}}else{g.areaSelectHandle(j)}}});this.areaSelectHandle=function(j){var p=j.x;var o=j.y;var k=p>=g.stage.mouseDownX?g.stage.mouseDownX:p;var h=o>=g.stage.mouseDownY?g.stage.mouseDownY:o;var l=Math.abs(p-g.stage.mouseDownX);var q=Math.abs(o-g.stage.mouseDownY);g.clearOperations().addOperation(function(i){i.beginPath();i.strokeStyle="rgba(0,0,236,0.5)";i.fillStyle="rgba(0,0,236,0.1)";i.rect(k,h,l,q);i.fill();i.stroke();i.closePath()});for(var n=0;n<g.elements.length;n++){var m=g.elements[n];if(m.x>k&&m.x+m.width<k+l){if(m.y>h&&m.y+m.height<h+q){g.pushSelected(m)}}else{if(!j.ctrlKey){m.cancleSelected()}}}};this.addEventListener("_mousemove",function(k){var j=k.x;var m=k.y;var i=g.getelementByXY(j,m);if(i){if(g.mouseOverelement&&g.mouseOverelement!==i){g.mouseOverelement.onMouseout(k)}g.mouseOverelement=i;if(!i.isOnMousOver){var l=b.util.clone(k);l.target=i;i.onMouseover(l);g.dispatchEvent("mouseover",l)}}else{if(g.mouseOverelement){var l=b.util.clone(k);l.target=i;g.mouseOverelement.onMouseout(l);g.dispatchEvent("mouseout",l);g.mouseOverelement=null}}var h=g.getControlRectByXY(j,m);if(h!=null&&h.element.resizeAble){g.setCusorByControlRectPosition(h.position)}});this.elementResizeHandle=function(j,m,l){var n=j.element;var i=j.position;if(i=="top_left"){if(n.width>1&&n.height>1){n.x=n.resizeLocation.x+m;n.y=n.resizeLocation.y+l}l=-l;m=-m}else{if(i=="top_center"){if(n.height>1){n.y=n.resizeLocation.y+l}l=-l;m=0}else{if(i=="top_right"){if(n.width>1&&n.height>1){n.y=n.resizeLocation.y+l}l=-l}else{if(i=="bottom_left"){if(n.width>1){n.x=n.resizeLocation.x+m}m=-m}else{if(i=="middle_left"){if(n.width>1){n.x=n.resizeLocation.x+m}m=-m;l=0}else{if(i=="bottom_center"){m=0}else{if(i=="middle_right"){l=0}}}}}}}var k=n.selectedWidth+m;var o=n.selectedHeight+l;if(k<=0){k=1}if(o<=0){o=1}n.width=k;n.height=o};var f={top_left:"nw-resize",top_center:"n-resize",top_right:"ne-resize",middle_left:"e-resize",middle_right:"e-resize",bottom_left:"ne-resize",bottom_center:"n-resize",bottom_right:"nw-resize"};this.setCusorByControlRectPosition=function(h){var i=f[h];if(i!=null){this.stage.canvas.style.cursor=i}};this.getControlRectByXY=function(s,p){if(this.selectedElements.length>0){for(var l=0;l<this.selectedElements.length;l++){var m=this.selectedElements[l];var n=this.getElementControlRects(m);for(var j in n){var h=n[j];h.element=m;var q={x:m.x+m.width*m.scalaX/2,y:m.y+m.height*m.scalaY/2};var o={x:q.x+h.x,y:q.y+h.y,width:h.width,height:h.height};if(b.util.isPointInRect({x:s,y:p},o)){return h}}}}return null};this.addEventListener("_mouseup",function(j){var h=j.x;var l=j.y;var i=g.currentelement;g.clearOperations();var k=b.util.clone(j);if(g.currentelement){g.currentelement.onMouseup(k);k.target=g.currentelement;g.dispatchEvent("mouseup",k)}else{g.dispatchEvent("mouseup",k)}if(i){if(i.layout&&i.layout.auto==true){g.layoutNode(i)}}});this.isAllEndpoint=function(h){for(var j=0;j<h.length;j++){var k=this.getChilds(h[j]);if(k.length>0){return false}}return true};this.getChilds=function(k){var h=[];for(var j=0;j<this.links.length;j++){if(this.links[j].nodeA===k){h.push(this.links[j].nodeZ)}}return h};this.layoutNode=function(j){var k=this.getChilds(j);if(k.length==0){return null}b.Layout.adjustPosition(j,k);if(this.isAllEndpoint(k)){return null}for(var h=0;h<k.length;h++){this.layoutNode(k[h])}return null};return g}a.prototype=new b.AbstractScene();b.Scene=a})(JTopo);(function(c){function a(){this.initialize=function(){this.shadow=true};this.getLocation=function(f,g){return{x:this.x,y:this.y}};this.setLocation=function(f,g){this.x=f;this.y=g;return this};this.setCenterLocation=function(f,g){this.x=f-this.width/2;this.y=g-this.height/2;return this};this.getCenterLocation=this.getCenterXY=function(){return{x:this.x+this.width/2,y:this.y+this.height/2}};this.getSize=function(){return{width:this.width,height:this.heith}};this.setSize=function(g,f){this.width=g;this.height=f;return this};this.setBound=function(g,i,h,f){this.setLocation(g,i);this.setSize(h,f);return this};this.getBound=function(){return{left:this.x,top:this.y,right:this.x+this.width,bottom:this.y+this.height}};this.getDisplaySize=function(){return{width:this.width*this.scalaX,height:this.height*this.scalaY}};this.onSelected=function(){this.selected=true;this.selectedLocation={x:this.x,y:this.y}};this.cancleSelected=function(){this.selected=false;this.selectedLocation=null};this.onDbclick=function(f){this.onDbclickX=f.x;this.onDbclickY=f.y;f.target=this;this.dispatchEvent("dbclick",f)};this.onClick=function(f){this.clickX=f.x;this.clickY=f.y;this.onSelected();f.target=this;this.dispatchEvent("click",f)};this.onMousedown=function(f){this.mousedownX=f.x;this.mousedownY=f.y;this.onSelected();f.target=this;this.dispatchEvent("mousedown",f)};this.onMouseup=function(f){this.mouseupX=f.x;this.mouseupY=f.y;this.isOnMousedrag=false;f.target=this;this.dispatchEvent("mouseup",f)};this.onMouseover=function(f){this.isOnMousOver=true;this.dispatchEvent("mouseover",f)};this.onMouseout=function(f){this.isOnMousOver=false;f.target=this;this.dispatchEvent("mouseout",f)};this.onMousedrag=function(i){this.isOnMousedrag=true;var g=i.dx;var f=i.dy;var j=this.selectedLocation.x+g;var h=this.selectedLocation.y+f;this.setLocation(j,h);i.target=this;this.dispatchEvent("mousedrag",i)};this.paint=function(f){f.beginPath();f.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")";f.rect(-this.width/2,-this.height/2,this.width,this.height);f.fill();f.closePath()};this.addEventListener=function(f,g){if(!this.messageBus){this.messageBus=new c.util.MessageBus()}this.messageBus.subscribe(f,g);return this};this.dispatchEvent=function(f,g){if(!this.messageBus){return null}this.messageBus.publish(f,g);return this}}function b(){this.initialize=function(){b.prototype.initialize.apply(this,arguments);this.x=0;this.y=0;this.width=32;this.height=32;this.visible=true;this.translate=true;this.alpha=1;this.rotate=0;this.scalaX=1;this.scalaY=1;this.style={fillStyle:"22,119,238"};this.editable=true;this.resizeAble=true};this.initialize(arguments)}b.prototype=new a();function e(f,g){this.initialize();this.style.background="auto-size";var h=e.imageChace;if(h==null){h=e.imageChace={}}this.setImage=function(j,k){var i=this;if(typeof j=="string"){var l=h[j];if(l==null){l=new Image();l.src=j;if(k){l.onload=function(){h[j]=l;i.setSize(l.width,l.height)}}}else{if(k){this.setSize(l.width,l.height)}}this.image=l}else{this.image=j;if(k&&j&&j.width&&j.height){this.setSize(j.width,j.height)}}};if(f){this.setImage(f,g)}this.paint=function(i){if(!this.image){return}i.save();i.beginPath();i.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")";this.paintImage(i);i.fill();i.closePath();i.restore()};this.paintImage=function(i){i.drawImage(this.image,-this.width/2,-this.height/2,this.width,this.height)}}e.prototype=new b();function d(f){this.initialize();this.paint=f}d.prototype=new b();c.AbstractElement=a;c.Element=b;c.ImageElement=e;c.CustomElement=d})(JTopo);(function(j){function h(k){this.initialize=function(l){h.prototype.initialize.apply(this,arguments);this.style.fontColor="255,255,255";this.style.fontSize="10pt";this.style.font="Consolas";this.name=l;this.dragable=true;this.selectable=true;this.selected=false;this.label={position:"Bottom_Center"}};this.initialize(k);this.paint=function(l){if(this.selected||this.isOnMousOver){this.drawSelectedRect(l)}if(this.image){h.prototype.paint.call(this,l)}else{l.beginPath();l.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")";l.rect(-this.width/2,-this.height/2,this.width,this.height);l.fill();l.closePath()}this.drawText(l)};this.drawSelectedRect=function(m){if(!this.selectable){return}var p=this.name;var o=p?m.measureText(p).width:0;var n=p?16:6;var l=Math.max(this.width,o);m.save();m.beginPath();m.strokeStyle="rgba(168,202,255, 0.9)";m.fillStyle="rgba(168,202,236,0.7)";m.rect(-l/2-3,-this.height/2-3,l+6,this.height+n);m.fill();m.stroke();m.closePath();m.restore()};this.drawText=function(l){var m=this.name;if(!m||m==""){return}var o=l.measureText(m).width;l.beginPath();l.font=this.style.fontSize+" "+this.style.font;l.fillStyle="rgba("+this.style.fontColor+", "+this.alpha+")";var n=this.getTextPostion(this.label.position,o);l.fillText(m,n.x,n.y);l.closePath()};this.getTextPostion=function(o,q){var n={Top_Center:function(){return{x:-this.width/2+(this.width-q)/2,y:-this.height/2}},Top_Right:function(){return{x:this.width/2,y:-this.height/2}},Top_Left:function(){return{x:-this.width/2-q,y:-this.height/2}},Bottom_Center:function(){return{x:-this.width/2+(this.width-q)/2,y:this.height/2+12}},Bottom_Right:function(){return{x:this.width/2,y:this.height/2+12}},Bottom_Left:function(){return{x:-this.width/2-q,y:this.height/2+12}},Middle_Center:function(){return{x:-this.width/2+(this.width-q)/2,y:0}},Middle_Right:function(){return{x:this.width/2,y:0}},Middle_Left:function(){return{x:-this.width/2-q,y:0}}};var m=n[o];if(m==null){m=n.Bottom_Center}var l=m.call(this);if(this.label.offsetX&&(typeof this.label.offsetX)==="number"){l.x+=this.label.offsetX}if(this.label.offsetY&&(typeof this.label.offsetY)==="number"){l.y+=this.label.offsetY}return l}}h.prototype=new j.ImageElement();function a(k){this.initialize();this.height=14;this.name=k;this.paint=function(l){var m=l.measureText(this.name).width;this.width=m;l.beginPath();l.font=this.style.fontSize+" "+this.style.font;l.strokeStyle="rgba("+this.style.fontColor+", "+this.alpha+")";l.strokeText(this.name,-this.width/2,-this.height/2+12);l.closePath()}}a.prototype=new h();function i(k){this.initialize();this.setSize(100,100);this.name=k;this.translate=false;this.paint=function(m){if(!this.visible){return}var l=this.x;var n=this.y;m.beginPath();m.strokeStyle="rgba(230, 230, 230, 0.8)";m.moveTo(l+50,n);m.quadraticCurveTo(l,n,l,n+37.5);m.quadraticCurveTo(l,n+75,l+25,n+75);m.quadraticCurveTo(l+25,n+95,l+5,n+100);m.quadraticCurveTo(l+35,n+95,l+45,n+75);m.quadraticCurveTo(l+100,n+75,l+100,n+37.5);m.quadraticCurveTo(l+100,n,l+50,n);m.strokeText(this.name,this.x+20,this.y+20);m.stroke();m.closePath()}}i.prototype=new h();function d(){this.initialize();this.setSize(120,120);this.translate=false;this.paint=function(k){if(!this.visible){return}k.save();k.beginPath();k.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")";k.moveTo(this.x+75,this.y+40);k.bezierCurveTo(this.x+75,this.y+37,this.x+70,this.y+25,this.x+50,this.y+25);k.bezierCurveTo(this.x+20,this.y+25,this.x+20,this.y+62.5,this.x+20,this.y+62.5);k.bezierCurveTo(this.x+20,this.y+80,this.x+40,this.y+102,this.x+75,this.y+120);k.bezierCurveTo(this.x+110,this.y+102,this.x+130,this.y+80,this.x+130,this.y+62.5);k.bezierCurveTo(this.x+130,this.y+62.5,this.x+130,this.y+25,this.x+100,this.y+25);k.bezierCurveTo(this.x+85,this.y+25,this.x+75,this.y+37,this.x+75,this.y+40);k.fill();k.closePath();k.restore()}}d.prototype=new h();function f(k){this.initialize();this.style.fillStyle="71, 167, 184";this.className=k;this.rowHeight=18;this.width=268;this.classObj=null;this.translate=false;this.operations=null;this.attributes=null;this.maxItem=10;this.paint=function(q){if(!this.visible){return}if(this.classObj!=null){this.operations=[];this.attributes=[];for(var n in this.classObj){if(p>this.maxItem){break}var t=this.classObj[n];if(typeof t=="function"){var s="(";for(var p=0;p<t.length;p++){s+="arg"+p;if(p+1<t.length){s+=", "}}s+=")";if(n.length+s.length>35){this.operations.push("+ "+n+s.substring(0,35-n.length));this.operations.push("  "+s.substring(35-n.length))}else{this.operations.push("+ "+n+s)}}else{this.attributes.push("- "+n+": "+(typeof t))}}}if(this.operations==null||this.operations.length==0){this.operations=[" "]}if(this.attributes==null||this.attributes.length==0){this.attributes=[" "]}if(this.operations.length>this.maxItem){this.operations=this.operations.splice(0,this.maxItem);this.operations.push("  ...")}if(this.attributes.length>this.maxItem){this.attributes=this.attributes.splice(0,this.maxItem);this.attributes.push("  ...")}this.height=(this.operations.length+this.attributes.length+1)*this.rowHeight+3;q.save();q.beginPath();q.fillStyle="rgba(239,247,149,"+this.alpha+")";q.rect(this.x,this.y,this.width,this.height);q.shadowBlur=0;q.shadowOffsetX=0;q.shadowOffsetY=0;q.fill();q.font=this.style.fontSize+" "+this.style.font;q.moveTo(this.x,this.y+this.rowHeight+3);q.lineTo(this.x+this.width,this.y+this.rowHeight+3);var r=q.measureText(this.className).width;q.strokeText(this.className,this.x+(this.width-r)/2,this.y+this.rowHeight);for(var p=0;p<this.operations.length;p++){var o=this.operations[p];q.strokeText(o,this.x+5,this.y+this.rowHeight+this.rowHeight*(p+1))}q.moveTo(this.x,this.y+this.rowHeight*(this.operations.length+1)+3);q.lineTo(this.x+this.width,this.y+this.rowHeight*(this.operations.length+1)+3);var m=this.y+this.rowHeight*(this.operations.length+1);for(var p=0;p<this.attributes.length;p++){var l=this.attributes[p];q.strokeText(l,this.x+5,m+this.rowHeight*(p+1))}q.stroke();q.closePath();q.restore()}}f.prototype=new h();function c(k){this.width=-1;this.height=-1;this.initialize();this.radius=30;this.beginDegree=0;this.endDegree=2*Math.PI;this.name=k;this.paint=function(m){if(this.selected||this.isOnMousOver){this.drawSelectedRect(m)}if(this.visible==false){return}if(this.width==-1||this.height==-1){var l=this.radius*2;var n=this.radius*2;this.width=l;this.height=n}var o=Math.min(this.width/2,this.height/2);m.save();m.beginPath();m.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")";m.arc(0,0,o,this.beginDegree,this.endDegree,true);m.fill();m.closePath();m.restore();this.drawText(m)}}c.prototype=new h();function e(k,o,m){this.initialize();this.frameImages=k||[];this.frameIndex=0;this.isStop=true;var n=o||1000;this.repeatPlay=false;var l=this;this.nextFrame=function(){if(this.isStop){return}if(this.frameImages.length==null){return}this.frameIndex++;if(this.frameIndex>=this.frameImages.length){if(this.repeatPlay){this.frameIndex=0}else{return}}this.setImage(this.frameImages[this.frameIndex],m);setTimeout(function(){l.nextFrame()},n/k.length)}}e.prototype=new h();function g(q,n,p,o,m){this.initialize();var k=this;this.setImage(q);this.frameIndex=0;this.isPause=true;this.repeatPlay=false;var l=o||1000;m=m||0;this.paint=function(u){if(!this.image){return}var r=this.width;var t=this.height;u.save();u.beginPath();u.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")";var v=(Math.floor(this.frameIndex/p)+m)*t;var s=Math.floor(this.frameIndex%p)*r;u.drawImage(this.image,s,v,r,t,-r/2,-t/2,r,t);u.fill();u.closePath();u.restore()};this.nextFrame=function(){if(this.isStop){return}this.frameIndex++;if(this.frameIndex>=n*p){if(this.repeatPlay){this.frameIndex=0}else{return}}setTimeout(function(){if(k.isStop){return}k.nextFrame()},l/(n*p))}}g.prototype=new h();function b(){var k=null;if(arguments.length<=3){k=new e(arguments[0],arguments[1],arguments[2])}else{k=new g(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])}k.stop=function(){k.isStop=true};k.play=function(){k.isStop=false;k.frameIndex=0;k.nextFrame()};return k}b.prototype=new h();j.Node=h;j.TextNode=a;j.UMLClassNode=f;j.TipNode=i;j.HeartNode=d;j.CircleNode=c;j.AnimateNode=b})(JTopo);(function(e){function d(j,i,h){this.initialize=function(m,l,k){if(arguments.length==0){return}this.name=k;this.nodeA=m;this.nodeZ=l;this.alpha=1;this.style={strokeStyle:"116, 166, 250",fillStyle:"116, 166, 250",lineWidth:2,fontSize:"12pt",fontColor:"255,255,0",lineJoin:"miter"};this.visible=true};this.initialize(j,i,h);this.paint=function(k){if(!this.nodeA||!this.nodeZ){return}k.beginPath();k.strokeStyle="rgba("+this.style.strokeStyle+","+this.alpha+")";k.lineWidth=this.style.lineWidth;if(j===i){k.arc(this.nodeA.x,this.nodeA.y,j.width/2,0,2*Math.PI)}else{k.moveTo(this.nodeA.x+this.nodeA.width/2,this.nodeA.y+this.nodeA.height/2);k.lineTo(this.nodeZ.x+this.nodeZ.width/2,this.nodeZ.y+this.nodeZ.height/2)}k.stroke();k.closePath();this.paintText(k)};this.paintText=function(l){if(this.name){var k=this.name;if(!k||k==""){return}var m=l.measureText(k).width;l.beginPath();l.lineWidth=1;l.font=this.style.fontSize+" "+this.style.font;l.strokeStyle="rgba("+this.style.fontColor+", "+this.alpha+")";l.strokeText(k,this.nodeA.x+(this.nodeZ.x-this.nodeA.x)/2,this.nodeA.y+(this.nodeZ.y-this.nodeA.y)/2+12);l.stroke();l.closePath()}};this.isInPath=function(l){var k=this.nodeA.getCenterXY();var m=this.nodeZ.getCenterXY();return e.util.isPointInLine(l,k,m)}}d.prototype=new e.AbstractElement();function f(k,j,i,h){this.initialize=function(){f.prototype.initialize.apply(this,arguments);this.fold=h||"x"};this.initialize(k,j,i,h);this.paint=function(l){if(!this.nodeA||!this.nodeZ){return}var n=this.nodeA.getCenterXY();var m=this.nodeZ.getCenterXY();l.save();l.beginPath();l.lineJoin=this.style.lineJoin;l.strokeStyle="rgba("+this.style.strokeStyle+","+this.alpha+")";l.lineWidth=this.style.lineWidth;l.moveTo(n.x,n.y);if(this.fold=="y"){l.lineTo(n.x,m.y)}else{l.lineTo(m.x,n.y)}l.lineTo(m.x,m.y);l.stroke();l.closePath();l.restore()}}f.prototype=new d();function g(j,i,h){this.initialize=function(){g.prototype.initialize.apply(this,arguments);this.arrowsSize=20;this.fillArrows=false};this.initialize(j,i,h);this.paint=function(l){if(!this.nodeA||!this.nodeZ){return}l.beginPath();l.strokeStyle="rgba("+this.style.strokeStyle+","+this.alpha+")";l.lineWidth=this.style.lineWidth;l.lineJoin=this.style.lineJoin;var m={x:this.nodeA.x+this.nodeA.width/2,y:this.nodeA.y+this.nodeA.height/2};var o={x:this.nodeZ.x+this.nodeZ.width/2,y:this.nodeZ.y+this.nodeZ.height/2};var p=Math.atan2(m.y-o.y,m.x-o.x);o.x=o.x+Math.cos(p)*this.nodeZ.width/2;o.y=o.y+Math.sin(p)*this.nodeZ.height/2;var n=0.4;var k={x:o.x+Math.cos(p-n)*this.arrowsSize,y:o.y+Math.sin(p-n)*this.arrowsSize};var q={x:o.x+Math.cos(p+n)*this.arrowsSize,y:o.y+Math.sin(p+n)*this.arrowsSize};l.moveTo(this.nodeA.x+this.nodeA.width/2,this.nodeA.y+this.nodeA.height/2);l.lineTo(k.x+(q.x-k.x)/2,k.y+(q.y-k.y)/2);l.stroke();l.closePath();l.beginPath();l.moveTo(k.x,k.y);l.lineTo(o.x,o.y);l.lineTo(q.x,q.y);l.lineTo(k.x,k.y);if(this.fillArrows==true){l.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")";l.fill()}l.stroke();l.closePath()}}g.prototype=new d();function c(k,j,i,h){this.initialize=function(){c.prototype.initialize.apply(this,arguments);this.arrowsSize=20;this.fillArrows=false;this.fold=h||"x"};this.initialize(k,j,i,h);this.paint=function(w){if(!this.nodeA||!this.nodeZ){return}var n=this.nodeA.x;var r=this.nodeA.y;var m=this.nodeZ.x;var q=this.nodeZ.y;var u=n;var s=r;if(n==m||r==q){w.beginPath();w.strokeStyle="rgba("+this.style.strokeStyle+","+this.alpha+")";w.lineWidth=this.style.lineWidth;w.lineJoin=this.style.lineJoin;var p={x:this.nodeA.x+this.nodeA.width/2,y:this.nodeA.y+this.nodeA.height/2};var v={x:this.nodeZ.x+this.nodeZ.width/2,y:this.nodeZ.y+this.nodeZ.height/2};var o=Math.atan2(p.y-v.y,p.x-v.x);v.x=v.x+Math.cos(o)*this.nodeZ.width/2;v.y=v.y+Math.sin(o)*this.nodeZ.height/2;var y=0.4;var l={x:v.x+Math.cos(o-y)*this.arrowsSize,y:v.y+Math.sin(o-y)*this.arrowsSize};var x={x:v.x+Math.cos(o+y)*this.arrowsSize,y:v.y+Math.sin(o+y)*this.arrowsSize};w.lineTo(l.x+(x.x-l.x)/2,l.y+(x.y-l.y)/2);w.stroke();w.closePath();w.beginPath();w.moveTo(l.x,l.y);w.lineTo(v.x,v.y);w.lineTo(x.x,x.y);w.lineTo(l.x,l.y);if(this.fillArrows==true){w.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")";w.fill()}w.closePath();w.stroke()}else{if(this.fold=="x"){u=n+(m-n)}else{s=r+(q-r)}w.beginPath();w.strokeStyle="rgba("+this.style.strokeStyle+","+this.alpha+")";w.lineWidth=this.style.lineWidth;w.lineJoin=this.style.lineJoin;w.moveTo(n+this.nodeA.width/2,r+this.nodeA.height/2);w.lineTo(u+this.nodeA.width/2,s+this.nodeA.height/2);var p={x:u+this.nodeA.width/2,y:s+this.nodeA.height/2};var v={x:this.nodeZ.x+this.nodeZ.width/2,y:this.nodeZ.y+this.nodeZ.height/2};var o=Math.atan2(p.y-v.y,p.x-v.x);v.x=v.x+Math.cos(o)*this.nodeZ.width/2;v.y=v.y+Math.sin(o)*this.nodeZ.height/2;var y=0.4;var l={x:v.x+Math.cos(o-y)*this.arrowsSize,y:v.y+Math.sin(o-y)*this.arrowsSize};var x={x:v.x+Math.cos(o+y)*this.arrowsSize,y:v.y+Math.sin(o+y)*this.arrowsSize};w.lineTo(l.x+(x.x-l.x)/2,l.y+(x.y-l.y)/2);w.stroke();w.closePath();w.beginPath();w.moveTo(l.x,l.y);w.lineTo(v.x,v.y);w.lineTo(x.x,x.y);w.lineTo(l.x,l.y);if(this.fillArrows==true){w.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")";w.fill()}w.stroke();w.closePath()}}}c.prototype=new d();function b(k,j,h){this.initialize=function(){c.prototype.initialize.apply(this,arguments);this.flexional={direction:"vertical",extend:function(){return 20}}};this.initialize(k,j,h);var i=this.paintText;this.paint=function(m){if(!this.nodeA||!this.nodeZ){return}var p=this.nodeA.x;var r=this.nodeA.y;var o=this.nodeZ.x;var q=this.nodeZ.y;m.beginPath();m.lineJoin=this.style.lineJoin;m.strokeStyle="rgba("+this.style.strokeStyle+","+this.alpha+")";m.lineWidth=this.style.lineWidth;if(p==o||r==q){m.moveTo(this.nodeA.x+this.nodeA.width/2,this.nodeA.y+this.nodeA.height/2);m.lineTo(this.nodeZ.x+this.nodeZ.width/2,this.nodeZ.y+this.nodeZ.height/2)}else{var n=(this.flexional.direction=="horizontal"?this.flexional.extend():0);var l=(this.flexional.direction=="vertical"?this.flexional.extend():0);n*=(o-p)>0?1:-1;l*=(q-r)>0?1:-1;m.moveTo(p+this.nodeA.width/2,r+this.nodeA.height/2);m.lineTo(p+this.nodeA.width/2+n,r+this.nodeA.height/2+l);m.lineTo(o+this.nodeA.width/2-n,q+this.nodeA.height/2-l);m.lineTo(o+this.nodeA.width/2,q+this.nodeA.height/2)}m.stroke();m.closePath();i.call(this,m)}}b.prototype=new d();function a(j,i,h){this.initialize=function(){c.prototype.initialize.apply(this,arguments)};this.initialize(j,i,h);this.flexional.extend=function(){if(this.flexional.direction=="horizontal"){return Math.abs(i.x-j.x)/2}else{return Math.abs(i.y-j.y)/2}}}a.prototype=new b();e.Link=d;e.FoldLink=f;e.ArrowsLink=g;e.ArrowsFoldLink=c;e.FlexionalLink=b;e.OrthogonalLink=a})(JTopo);(function(c){function b(e){this.initialize=function(f){b.prototype.initialize.apply(this,null);this.name=f;this.x=0;this.y=0;this.width=100;this.height=100;this.items=[];this.style={fillStyle:"255, 255, 255"};this.alpha=0.6;this.dragable=true;this.childDragble=null;this.visible=true};this.initialize(e);this.add=function(f){this.items.push(f);f.parentContainer=this;this.updateBound();if(this.childDragble){f.dragable=this.childDragble}};this.remove=function(g){for(var f=0;f<this.items.length;f++){if(this.items[f]===g){g.parentContainer=null;this.items=this.items.del(f);g.lastParentContainer=this;break}}};this.clear=this.removeAll=function(){for(var f=0;f<this.items.length;f++){this.remove(this.items[f])}};this.setLocation=function(f,l){var h=f-this.x;var g=l-this.y;this.x=f;this.y=l;for(var j=0;j<this.items.length;j++){var k=this.items[j];k.setLocation(k.x+h,k.y+g)}};this.updateBound=function(){for(var f=0;f<this.items.length;f++){var g=this.items[f];if(g.x<this.x){g.x=this.x}if(g.y<this.y){g.y=this.y}if(g.x+g.width>this.x+this.width){g.x=this.x+this.width-g.width}if(g.y+g.height>this.y+this.height){g.y=this.y+this.height-g.height}}};this.paint=function(f){if(this.layout){c.Layout.adjustPosition(this,this.items)}this.updateBound();if(!this.visible){return}f.beginPath();f.shadowBlur=9;f.shadowColor="rgba(0,0,0,0.5)";f.shadowOffsetX=3;f.shadowOffsetY=3;f.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")";f.fillRect(this.x,this.y,this.width,this.height);f.closePath()}}b.prototype=new c.AbstractElement();function d(){this.initialize(arguments);this.updateBound=function(){var k={x:10000000,y:1000000,width:0,height:0};if(this.items.length>0){var j=10000000;var f=-10000000;var h=10000000;var e=-10000000;var g=f-j;var m=e-h;for(var l=0;l<this.items.length;l++){var n=this.items[l];if(n.x<=j){j=n.x}if(n.x>=f){f=n.x}if(n.y<=h){h=n.y}if(n.y>=e){e=n.y}g=f-j+n.width;m=e-h+n.height}this.x=j;this.y=h;this.width=g;this.height=m}}}d.prototype=new b();function a(){this.initialize(arguments);this.paint=function(f){if(this.items.length<2){return}var j=[];for(var e=0;e<this.items.length;e++){var h=this.items[e].getCenterXY();j.push(h)}for(var e=0;e<j.length-2;e+=3){f.beginPath();f.moveTo(j[e].x,j[e].y);this.items[e+1].style.fillStyle="0,255,0";f.quadraticCurveTo(j[e+1].x,j[e+1].y,j[e+2].x,j[e+2].y);f.stroke();f.closePath();f.save();f.beginPath();f.lineWidth=1;f.strokeStyle="rgba(0,255,0,0.3)";f.moveTo(j[e].x,j[e].y);f.lineTo(j[e+1].x,j[e+1].y);f.stroke();f.closePath();f.restore()}}}a.prototype=new b();c.Container=b;c.AutoSizeContainer=d;c.EditContainer=a})(JTopo);(function(b){function a(r,q,l,m,n,o){var g=n?n:0;var j=o?o:2*Math.PI;var p=j-g;var h=p/l;var u=[];g+=h/2;for(var k=g;k<=j;k+=h){var t=r+Math.cos(k)*m;var s=q+Math.sin(k)*m;u.push({x:t,y:s})}return u}function c(p,n,m,g,k,j){var o=j||"bottom";var q=[];if(o=="bottom"){var h=p-(m/2)*g+g/2;for(var l=0;l<=m;l++){q.push({x:h+l*g,y:n+k})}}else{if(o=="top"){var h=p-(m/2)*g+g/2;for(var l=0;l<=m;l++){q.push({x:h+l*g,y:n-k})}}else{if(o=="right"){var h=n-(m/2)*g+g/2;for(var l=0;l<=m;l++){q.push({x:p+k,y:h+l*g})}}else{if(o=="left"){var h=n-(m/2)*g+g/2;for(var l=0;l<=m;l++){q.push({x:p-k,y:h+l*g})}}}}}return q}function f(p,n,m,g,k,j){var o=j||"horizontal";var s=[];var q=Math.round(m/2);var h=p+g;if(o=="horizontal"){for(var l=0;l<q;l++){s.push({x:h+l*g,y:n-k})}for(var l=q;l<=m;l++){s.push({x:h+l*g,y:n+k})}}else{if(o=="vertical"){}}return s}function e(o,m,p,n,g,h){var q=[];for(var l=0;l<p;l++){for(var k=0;k<n;k++){q.push({x:o+k*g,y:m+l*h})}}return q}function d(l,m){if(!l.layout){return}var k=l.layout;var j=k.type;var h=null;var n=l.getCenterXY();if(j=="star"){h=a(n.x,n.y,m.length,l.layout.radius,l.layout.beginDegree,l.layout.endDegree)}else{if(j=="tree"){h=c(n.x,n.y,m.length,k.width,k.height,k.direction)}else{if(j=="grid"){h=e(n.x,n.y,k.rows,k.cols,k.horizontal||0,k.vertical||0)}else{return}}}for(var g=0;g<m.length;g++){m[g].setCenterLocation(h[g].x,h[g].y)}}b.Layout={adjustPosition:d}})(JTopo);(function(a){function b(){var c=new a.CircleNode();c.radius=150;c.colors=["#3666B0","#2CA8E0","#77D1F6"];c.datas=[0.3,0.3,0.4];c.translate=false;c.paint=function(e){var d=c.radius*2;var g=c.radius*2;c.width=d;c.height=d;var j=0;for(var f=0;f<this.datas.length;f++){var k=this.datas[f]*Math.PI*2;e.beginPath();e.fillStyle=c.colors[f];e.moveTo(this.x+d/2,this.y+g/2);e.arc(this.x+d/2,this.y+g/2,this.radius/2,j,j+k,false);e.fill();e.closePath();j+=k}};return c}a.PieChartNode=b})(JTopo);(function(c){c.Animate={};c.Effect={};function a(h,g){var f=null;var i;return{stop:function(){if(!i){return this}window.clearInterval(i);if(f){f.publish("stop")}return this},start:function(){var j=this;i=setInterval(function(){h.call(j)},g);return this},onStop:function(j){if(f==null){f=new c.util.MessageBus()}f.subscribe("stop",j);return this}}}function e(k,l){l=l||{};var m=l.gravity||0.1;var i=l.dx||0;var f=l.dy||5;var j=l.stop;var h=l.interval||30;var g=new a(function(){if(j&&j()){f=0.5;this.stop()}else{f+=m;k.setLocation(k.x+i,k.y+f)}},h);return g}function b(n,o,f,p,q){var h=50;var i={};for(var j in o){var m=o[j];var l=m-n[j];i[j]={oldValue:n[j],targetValue:m,step:l/f*h,isDone:function(s){var r=(this.step>0&&n[s]>=this.targetValue)||(this.step<0&&n[s]<=this.targetValue);return r}}}var g=new a(function(){var t=true;for(var s in o){if(i[s].isDone(s)){}else{n[s]+=i[s].step;t=false}}if(t){if(p){for(var s in o){if(q){var r=i[s].targetValue;i[s].targetValue=i[s].oldValue;i[s].oldValue=r;i[s].step=-i[s].step}else{n[s]=i[s].oldValue}}}else{return this.stop()}}},h);return g}function d(g,i){var f=g.style;var h=i.angle;function l(o,u,s,t,p){var q=new c.Node();q.setImage(g.image);q.setSize(g.width,g.height);q.style=f;q.setLocation(o,u);q.paint=function(r){r.save();r.arc(0,0,s,t,p);r.clip();r.beginPath();if(this.image!=null){r.drawImage(this.image,-this.width/2,-this.height/2)}else{r.fillStyle="rgba("+this.style.fillStyle+","+this.alpha+")";r.rect(this.x,this.y,this.width,this.height);r.fill()}r.closePath();r.restore()};return q}var j=h;var k=h+Math.PI;var n=l(g.x,g.y,g.width,j,k);var m=l(g.x,g.y,g.width,j+Math.PI,j);return[n,m]}c.Animate.gravity=e;c.Animate.stepByStep=b;c.Effect.splitTwoPiece=d})(JTopo);
